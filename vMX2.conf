*****************************************

			APNIC BASE CONFIG

*****************************************





*************************** ACLs *************************


set logical-systems PE7 firewall family inet filter protect-RE-private term first-frag from first-fragment
set logical-systems PE7 firewall family inet filter protect-RE-private term first-frag then discard
set logical-systems PE7 firewall family inet filter protect-RE-private term next-frag from is-fragment
set logical-systems PE7 firewall family inet filter protect-RE-private term next-frag then discard
set logical-systems PE7 firewall family inet filter protect-RE-private term ssh-in from source-prefix-list inet:ssh-prefix
set logical-systems PE7 firewall family inet filter protect-RE-private term ssh-in from protocol tcp
set logical-systems PE7 firewall family inet filter protect-RE-private term ssh-in from port ssh
set logical-systems PE7 firewall family inet filter protect-RE-private term ssh-in then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term snmp-limit from source-prefix-list inet:snmp-prefix
set logical-systems PE7 firewall family inet filter protect-RE-private term snmp-limit from protocol udp
set logical-systems PE7 firewall family inet filter protect-RE-private term snmp-limit from port snmp
set logical-systems PE7 firewall family inet filter protect-RE-private term snmp-limit then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term bgp-in from source-prefix-list inet:bgp-prefix
set logical-systems PE7 firewall family inet filter protect-RE-private term bgp-in from protocol tcp
set logical-systems PE7 firewall family inet filter protect-RE-private term bgp-in from port bgp
set logical-systems PE7 firewall family inet filter protect-RE-private term bgp-in then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term traceroute-in from source-prefix-list inet:internal-prefix
set logical-systems PE7 firewall family inet filter protect-RE-private term traceroute-in from protocol udp
set logical-systems PE7 firewall family inet filter protect-RE-private term traceroute-in from destination-port 33434-33523
set logical-systems PE7 firewall family inet filter protect-RE-private term traceroute-in then policer 10m-policer
set logical-systems PE7 firewall family inet filter protect-RE-private term traceroute-in then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term bfd-in from source-prefix-list inet:bgp-prefix
set logical-systems PE7 firewall family inet filter protect-RE-private term bfd-in from protocol udp
set logical-systems PE7 firewall family inet filter protect-RE-private term bfd-in from destination-port 3784
set logical-systems PE7 firewall family inet filter protect-RE-private term bfd-in then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term icmp-limit from source-prefix-list inet:internal-prefix
set logical-systems PE7 firewall family inet filter protect-RE-private term icmp-limit from protocol icmp
set logical-systems PE7 firewall family inet filter protect-RE-private term icmp-limit then policer 10m-policer
set logical-systems PE7 firewall family inet filter protect-RE-private term icmp-limit then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term ntp-in from source-prefix-list inet:ntp-server
set logical-systems PE7 firewall family inet filter protect-RE-private term ntp-in from protocol udp
set logical-systems PE7 firewall family inet filter protect-RE-private term ntp-in from port ntp
set logical-systems PE7 firewall family inet filter protect-RE-private term ntp-in then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term tacacs-reply from source-prefix-list inet:tacacs-servers
set logical-systems PE7 firewall family inet filter protect-RE-private term tacacs-reply from protocol tcp
set logical-systems PE7 firewall family inet filter protect-RE-private term tacacs-reply from source-port 49
set logical-systems PE7 firewall family inet filter protect-RE-private term tacacs-reply then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term dns-reply from source-prefix-list inet:dns-servers
set logical-systems PE7 firewall family inet filter protect-RE-private term dns-reply from protocol udp
set logical-systems PE7 firewall family inet filter protect-RE-private term dns-reply from source-port domain
set logical-systems PE7 firewall family inet filter protect-RE-private term dns-reply then accept
set logical-systems PE7 firewall family inet filter protect-RE-private term discard-last then discard

set logical-systems PE7 firewall family inet filter protect-RE-vpn term first-frag from first-fragment
set logical-systems PE7 firewall family inet filter protect-RE-vpn term first-frag then discard
set logical-systems PE7 firewall family inet filter protect-RE-vpn term next-frag from is-fragment
set logical-systems PE7 firewall family inet filter protect-RE-vpn term next-frag then discard
set logical-systems PE7 firewall family inet filter protect-RE-vpn term traceroute-limit from protocol udp
set logical-systems PE7 firewall family inet filter protect-RE-vpn term traceroute-limit from destination-port 33434-33523
set logical-systems PE7 firewall family inet filter protect-RE-vpn term traceroute-limit then policer 10m-policer
set logical-systems PE7 firewall family inet filter protect-RE-vpn term traceroute-limit then count traceroute-traffic
set logical-systems PE7 firewall family inet filter protect-RE-vpn term traceroute-limit then accept
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit from protocol icmp
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-request
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-reply
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type unreachable
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type time-exceeded
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit then count icmp-traffic
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit then policer 10m-policer
set logical-systems PE7 firewall family inet filter protect-RE-vpn term icmp-limit then accept
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bgp-limit from source-prefix-list RI:bgp-prefix
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bgp-limit from protocol tcp
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bgp-limit from port bgp
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bgp-limit then accept
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bfd-in from source-prefix-list RI:bgp-prefix
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bfd-in from protocol udp
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3784
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3785
set logical-systems PE7 firewall family inet filter protect-RE-vpn term bfd-in then accept
set logical-systems PE7 firewall family inet filter protect-RE-vpn term discard-last then count discard-traffic
set logical-systems PE7 firewall family inet filter protect-RE-vpn term discard-last then discard

set logical-systems PE7 firewall policer 10m-policer if-exceeding bandwidth-limit 10m
set logical-systems PE7 firewall policer 10m-policer if-exceeding burst-size-limit 256k
set logical-systems PE7 firewall policer 10m-policer then discard



	delete groups re-fw logical-systems PE7 interfaces lo0 unit <*> family inet filter input protect-RE-private
	delete logical-systems PE7 apply-groups re-fw
	delete groups vpn-fw logical-systems PE7 interfaces lo0 unit <*> family inet filter input protect-RE-vpn
	delete logical-systems PE7 apply-groups vpn-fw

set logical-systems PE7 policy-options prefix-list inet:snmp-prefix 176.67.173.172/32
set logical-systems PE7 policy-options prefix-list inet:snmp-prefix 69.36.160.0/24
set logical-systems PE7 policy-options prefix-list inet:snmp-prefix 77.92.94.112/28
set logical-systems PE7 policy-options prefix-list inet:snmp-prefix 209.50.158.0/23

set logical-systems PE7 policy-options prefix-list inet:ssh-prefix 77.92.94.112/28
set logical-systems PE7 policy-options prefix-list inet:ssh-prefix 83.170.64.10/32
set logical-systems PE7 policy-options prefix-list inet:ssh-prefix 69.36.160.0/24

set logical-systems PE7 policy-options prefix-list inet:internal-prefix 176.67.173.172/32
set logical-systems PE7 policy-options prefix-list inet:internal-prefix 69.36.160.0/24
set logical-systems PE7 policy-options prefix-list inet:internal-prefix 77.92.94.112/28
set logical-systems PE7 policy-options prefix-list inet:internal-prefix 209.50.158.0/23

set logical-systems PE7 policy-options prefix-list inet:bgp-prefix apply-path "logical-systems PE7 protocols bgp group <*> neighbor <*>"

set logical-systems PE7 policy-options prefix-list inet:radius-servers apply-path "system radius-server <*>"

set logical-systems PE7 policy-options prefix-list inet:tacacs-servers apply-path "system tacplus-server <*>"

set logical-systems PE7 policy-options prefix-list inet:ntp-server apply-path "system ntp server <*>"

set logical-systems PE7 policy-options prefix-list inet:dns-servers apply-path "system name-server <*>"

set logical-systems PE7 policy-options prefix-list RI:bgp-prefix apply-path "logical-systems PE7 protocols bgp group <*> neighbor <*>"






To check the apply paths are working issue the command show policy options prefix-list inet:ntp-server | display inheritance







-------------------------------------------




set logical-systems PE8 firewall family inet filter protect-RE-private term first-frag from first-fragment
set logical-systems PE8 firewall family inet filter protect-RE-private term first-frag then discard
set logical-systems PE8 firewall family inet filter protect-RE-private term next-frag from is-fragment
set logical-systems PE8 firewall family inet filter protect-RE-private term next-frag then discard
set logical-systems PE8 firewall family inet filter protect-RE-private term ssh-in from source-prefix-list inet:ssh-prefix
set logical-systems PE8 firewall family inet filter protect-RE-private term ssh-in from protocol tcp
set logical-systems PE8 firewall family inet filter protect-RE-private term ssh-in from port ssh
set logical-systems PE8 firewall family inet filter protect-RE-private term ssh-in then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term snmp-limit from source-prefix-list inet:snmp-prefix
set logical-systems PE8 firewall family inet filter protect-RE-private term snmp-limit from protocol udp
set logical-systems PE8 firewall family inet filter protect-RE-private term snmp-limit from port snmp
set logical-systems PE8 firewall family inet filter protect-RE-private term snmp-limit then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term bgp-in from source-prefix-list inet:bgp-prefix
set logical-systems PE8 firewall family inet filter protect-RE-private term bgp-in from protocol tcp
set logical-systems PE8 firewall family inet filter protect-RE-private term bgp-in from port bgp
set logical-systems PE8 firewall family inet filter protect-RE-private term bgp-in then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term traceroute-in from source-prefix-list inet:internal-prefix
set logical-systems PE8 firewall family inet filter protect-RE-private term traceroute-in from protocol udp
set logical-systems PE8 firewall family inet filter protect-RE-private term traceroute-in from destination-port 33434-33523
set logical-systems PE8 firewall family inet filter protect-RE-private term traceroute-in then policer 10m-policer
set logical-systems PE8 firewall family inet filter protect-RE-private term traceroute-in then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term bfd-in from source-prefix-list inet:bgp-prefix
set logical-systems PE8 firewall family inet filter protect-RE-private term bfd-in from protocol udp
set logical-systems PE8 firewall family inet filter protect-RE-private term bfd-in from destination-port 3784
set logical-systems PE8 firewall family inet filter protect-RE-private term bfd-in then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term icmp-limit from source-prefix-list inet:internal-prefix
set logical-systems PE8 firewall family inet filter protect-RE-private term icmp-limit from protocol icmp
set logical-systems PE8 firewall family inet filter protect-RE-private term icmp-limit then policer 10m-policer
set logical-systems PE8 firewall family inet filter protect-RE-private term icmp-limit then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term ntp-in from source-prefix-list inet:ntp-server
set logical-systems PE8 firewall family inet filter protect-RE-private term ntp-in from protocol udp
set logical-systems PE8 firewall family inet filter protect-RE-private term ntp-in from port ntp
set logical-systems PE8 firewall family inet filter protect-RE-private term ntp-in then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term tacacs-reply from source-prefix-list inet:tacacs-servers
set logical-systems PE8 firewall family inet filter protect-RE-private term tacacs-reply from protocol tcp
set logical-systems PE8 firewall family inet filter protect-RE-private term tacacs-reply from source-port 49
set logical-systems PE8 firewall family inet filter protect-RE-private term tacacs-reply then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term dns-reply from source-prefix-list inet:dns-servers
set logical-systems PE8 firewall family inet filter protect-RE-private term dns-reply from protocol udp
set logical-systems PE8 firewall family inet filter protect-RE-private term dns-reply from source-port domain
set logical-systems PE8 firewall family inet filter protect-RE-private term dns-reply then accept
set logical-systems PE8 firewall family inet filter protect-RE-private term discard-last then discard

set logical-systems PE8 firewall family inet filter protect-RE-vpn term first-frag from first-fragment
set logical-systems PE8 firewall family inet filter protect-RE-vpn term first-frag then discard
set logical-systems PE8 firewall family inet filter protect-RE-vpn term next-frag from is-fragment
set logical-systems PE8 firewall family inet filter protect-RE-vpn term next-frag then discard
set logical-systems PE8 firewall family inet filter protect-RE-vpn term traceroute-limit from protocol udp
set logical-systems PE8 firewall family inet filter protect-RE-vpn term traceroute-limit from destination-port 33434-33523
set logical-systems PE8 firewall family inet filter protect-RE-vpn term traceroute-limit then policer 10m-policer
set logical-systems PE8 firewall family inet filter protect-RE-vpn term traceroute-limit then count traceroute-traffic
set logical-systems PE8 firewall family inet filter protect-RE-vpn term traceroute-limit then accept
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit from protocol icmp
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-request
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-reply
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type unreachable
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type time-exceeded
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit then count icmp-traffic
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit then policer 10m-policer
set logical-systems PE8 firewall family inet filter protect-RE-vpn term icmp-limit then accept
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bgp-limit from source-prefix-list RI:bgp-prefix
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bgp-limit from protocol tcp
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bgp-limit from port bgp
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bgp-limit then accept
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bfd-in from source-prefix-list RI:bgp-prefix
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bfd-in from protocol udp
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3784
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3785
set logical-systems PE8 firewall family inet filter protect-RE-vpn term bfd-in then accept
set logical-systems PE8 firewall family inet filter protect-RE-vpn term discard-last then count discard-traffic
set logical-systems PE8 firewall family inet filter protect-RE-vpn term discard-last then discard

set logical-systems PE8 firewall policer 10m-policer if-exceeding bandwidth-limit 10m
set logical-systems PE8 firewall policer 10m-policer if-exceeding burst-size-limit 256k
set logical-systems PE8 firewall policer 10m-policer then discard



	delete groups re-fw logical-systems PE8 interfaces lo0 unit <*> family inet filter input protect-RE-private
	delete logical-systems PE8 apply-groups re-fw
	delete groups vpn-fw logical-systems PE8 interfaces lo0 unit <*> family inet filter input protect-RE-vpn
	delete logical-systems PE8 apply-groups vpn-fw

set logical-systems PE8 policy-options prefix-list inet:snmp-prefix 176.67.173.172/32
set logical-systems PE8 policy-options prefix-list inet:snmp-prefix 69.36.160.0/24
set logical-systems PE8 policy-options prefix-list inet:snmp-prefix 77.92.94.112/28
set logical-systems PE8 policy-options prefix-list inet:snmp-prefix 209.50.158.0/23

set logical-systems PE8 policy-options prefix-list inet:ssh-prefix 77.92.94.112/28
set logical-systems PE8 policy-options prefix-list inet:ssh-prefix 83.170.64.10/32
set logical-systems PE8 policy-options prefix-list inet:ssh-prefix 69.36.160.0/24

set logical-systems PE8 policy-options prefix-list inet:internal-prefix 176.67.173.172/32
set logical-systems PE8 policy-options prefix-list inet:internal-prefix 69.36.160.0/24
set logical-systems PE8 policy-options prefix-list inet:internal-prefix 77.92.94.112/28
set logical-systems PE8 policy-options prefix-list inet:internal-prefix 209.50.158.0/23

set logical-systems PE8 policy-options prefix-list inet:bgp-prefix apply-path "logical-systems PE8 protocols bgp group <*> neighbor <*>"

set logical-systems PE8 policy-options prefix-list inet:radius-servers apply-path "system radius-server <*>"

set logical-systems PE8 policy-options prefix-list inet:tacacs-servers apply-path "system tacplus-server <*>"

set logical-systems PE8 policy-options prefix-list inet:ntp-server apply-path "system ntp server <*>"

set logical-systems PE8 policy-options prefix-list inet:dns-servers apply-path "system name-server <*>"

set logical-systems PE8 policy-options prefix-list RI:bgp-prefix apply-path "logical-systems PE8 protocols bgp group <*> neighbor <*>"






To check the apply paths are working issue the command show policy options prefix-list inet:ntp-server | display inheritance





------------------------

set logical-systems PE9 firewall family inet filter protect-RE-private term first-frag from first-fragment
set logical-systems PE9 firewall family inet filter protect-RE-private term first-frag then discard
set logical-systems PE9 firewall family inet filter protect-RE-private term next-frag from is-fragment
set logical-systems PE9 firewall family inet filter protect-RE-private term next-frag then discard
set logical-systems PE9 firewall family inet filter protect-RE-private term ssh-in from source-prefix-list inet:ssh-prefix
set logical-systems PE9 firewall family inet filter protect-RE-private term ssh-in from protocol tcp
set logical-systems PE9 firewall family inet filter protect-RE-private term ssh-in from port ssh
set logical-systems PE9 firewall family inet filter protect-RE-private term ssh-in then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term snmp-limit from source-prefix-list inet:snmp-prefix
set logical-systems PE9 firewall family inet filter protect-RE-private term snmp-limit from protocol udp
set logical-systems PE9 firewall family inet filter protect-RE-private term snmp-limit from port snmp
set logical-systems PE9 firewall family inet filter protect-RE-private term snmp-limit then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term bgp-in from source-prefix-list inet:bgp-prefix
set logical-systems PE9 firewall family inet filter protect-RE-private term bgp-in from protocol tcp
set logical-systems PE9 firewall family inet filter protect-RE-private term bgp-in from port bgp
set logical-systems PE9 firewall family inet filter protect-RE-private term bgp-in then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term traceroute-in from source-prefix-list inet:internal-prefix
set logical-systems PE9 firewall family inet filter protect-RE-private term traceroute-in from protocol udp
set logical-systems PE9 firewall family inet filter protect-RE-private term traceroute-in from destination-port 33434-33523
set logical-systems PE9 firewall family inet filter protect-RE-private term traceroute-in then policer 10m-policer
set logical-systems PE9 firewall family inet filter protect-RE-private term traceroute-in then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term bfd-in from source-prefix-list inet:bgp-prefix
set logical-systems PE9 firewall family inet filter protect-RE-private term bfd-in from protocol udp
set logical-systems PE9 firewall family inet filter protect-RE-private term bfd-in from destination-port 3784
set logical-systems PE9 firewall family inet filter protect-RE-private term bfd-in then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term icmp-limit from source-prefix-list inet:internal-prefix
set logical-systems PE9 firewall family inet filter protect-RE-private term icmp-limit from protocol icmp
set logical-systems PE9 firewall family inet filter protect-RE-private term icmp-limit then policer 10m-policer
set logical-systems PE9 firewall family inet filter protect-RE-private term icmp-limit then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term ntp-in from source-prefix-list inet:ntp-server
set logical-systems PE9 firewall family inet filter protect-RE-private term ntp-in from protocol udp
set logical-systems PE9 firewall family inet filter protect-RE-private term ntp-in from port ntp
set logical-systems PE9 firewall family inet filter protect-RE-private term ntp-in then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term tacacs-reply from source-prefix-list inet:tacacs-servers
set logical-systems PE9 firewall family inet filter protect-RE-private term tacacs-reply from protocol tcp
set logical-systems PE9 firewall family inet filter protect-RE-private term tacacs-reply from source-port 49
set logical-systems PE9 firewall family inet filter protect-RE-private term tacacs-reply then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term dns-reply from source-prefix-list inet:dns-servers
set logical-systems PE9 firewall family inet filter protect-RE-private term dns-reply from protocol udp
set logical-systems PE9 firewall family inet filter protect-RE-private term dns-reply from source-port domain
set logical-systems PE9 firewall family inet filter protect-RE-private term dns-reply then accept
set logical-systems PE9 firewall family inet filter protect-RE-private term discard-last then discard

set logical-systems PE9 firewall family inet filter protect-RE-vpn term first-frag from first-fragment
set logical-systems PE9 firewall family inet filter protect-RE-vpn term first-frag then discard
set logical-systems PE9 firewall family inet filter protect-RE-vpn term next-frag from is-fragment
set logical-systems PE9 firewall family inet filter protect-RE-vpn term next-frag then discard
set logical-systems PE9 firewall family inet filter protect-RE-vpn term traceroute-limit from protocol udp
set logical-systems PE9 firewall family inet filter protect-RE-vpn term traceroute-limit from destination-port 33434-33523
set logical-systems PE9 firewall family inet filter protect-RE-vpn term traceroute-limit then policer 10m-policer
set logical-systems PE9 firewall family inet filter protect-RE-vpn term traceroute-limit then count traceroute-traffic
set logical-systems PE9 firewall family inet filter protect-RE-vpn term traceroute-limit then accept
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit from protocol icmp
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-request
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-reply
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type unreachable
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type time-exceeded
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit then count icmp-traffic
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit then policer 10m-policer
set logical-systems PE9 firewall family inet filter protect-RE-vpn term icmp-limit then accept
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bgp-limit from source-prefix-list RI:bgp-prefix
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bgp-limit from protocol tcp
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bgp-limit from port bgp
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bgp-limit then accept
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bfd-in from source-prefix-list RI:bgp-prefix
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bfd-in from protocol udp
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3784
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3785
set logical-systems PE9 firewall family inet filter protect-RE-vpn term bfd-in then accept
set logical-systems PE9 firewall family inet filter protect-RE-vpn term discard-last then count discard-traffic
set logical-systems PE9 firewall family inet filter protect-RE-vpn term discard-last then discard

set logical-systems PE9 firewall policer 10m-policer if-exceeding bandwidth-limit 10m
set logical-systems PE9 firewall policer 10m-policer if-exceeding burst-size-limit 256k
set logical-systems PE9 firewall policer 10m-policer then discard




	delete groups re-fw logical-systems PE9 interfaces lo0 unit <*> family inet filter input protect-RE-private
	delete logical-systems PE9 apply-groups re-fw
	delete groups vpn-fw logical-systems PE9 interfaces lo0 unit <*> family inet filter input protect-RE-vpn
	delete logical-systems PE9 apply-groups vpn-fw

set logical-systems PE9 policy-options prefix-list inet:snmp-prefix 176.67.173.172/32
set logical-systems PE9 policy-options prefix-list inet:snmp-prefix 69.36.160.0/24
set logical-systems PE9 policy-options prefix-list inet:snmp-prefix 77.92.94.112/28
set logical-systems PE9 policy-options prefix-list inet:snmp-prefix 209.50.158.0/23

set logical-systems PE9 policy-options prefix-list inet:ssh-prefix 77.92.94.112/28
set logical-systems PE9 policy-options prefix-list inet:ssh-prefix 83.170.64.10/32
set logical-systems PE9 policy-options prefix-list inet:ssh-prefix 69.36.160.0/24

set logical-systems PE9 policy-options prefix-list inet:internal-prefix 176.67.173.172/32
set logical-systems PE9 policy-options prefix-list inet:internal-prefix 69.36.160.0/24
set logical-systems PE9 policy-options prefix-list inet:internal-prefix 77.92.94.112/28
set logical-systems PE9 policy-options prefix-list inet:internal-prefix 209.50.158.0/23

set logical-systems PE9 policy-options prefix-list inet:bgp-prefix apply-path "logical-systems PE9 protocols bgp group <*> neighbor <*>"

set logical-systems PE9 policy-options prefix-list inet:radius-servers apply-path "system radius-server <*>"

set logical-systems PE9 policy-options prefix-list inet:tacacs-servers apply-path "system tacplus-server <*>"

set logical-systems PE9 policy-options prefix-list inet:ntp-server apply-path "system ntp server <*>"

set logical-systems PE9 policy-options prefix-list inet:dns-servers apply-path "system name-server <*>"

set logical-systems PE9 policy-options prefix-list RI:bgp-prefix apply-path "logical-systems PE9 protocols bgp group <*> neighbor <*>"






To check the apply paths are working issue the command show policy options prefix-list inet:ntp-server | display inheritance




---------------------------------




set logical-systems PE10 firewall family inet filter protect-RE-private term first-frag from first-fragment
set logical-systems PE10 firewall family inet filter protect-RE-private term first-frag then discard
set logical-systems PE10 firewall family inet filter protect-RE-private term next-frag from is-fragment
set logical-systems PE10 firewall family inet filter protect-RE-private term next-frag then discard
set logical-systems PE10 firewall family inet filter protect-RE-private term ssh-in from source-prefix-list inet:ssh-prefix
set logical-systems PE10 firewall family inet filter protect-RE-private term ssh-in from protocol tcp
set logical-systems PE10 firewall family inet filter protect-RE-private term ssh-in from port ssh
set logical-systems PE10 firewall family inet filter protect-RE-private term ssh-in then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term snmp-limit from source-prefix-list inet:snmp-prefix
set logical-systems PE10 firewall family inet filter protect-RE-private term snmp-limit from protocol udp
set logical-systems PE10 firewall family inet filter protect-RE-private term snmp-limit from port snmp
set logical-systems PE10 firewall family inet filter protect-RE-private term snmp-limit then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term bgp-in from source-prefix-list inet:bgp-prefix
set logical-systems PE10 firewall family inet filter protect-RE-private term bgp-in from protocol tcp
set logical-systems PE10 firewall family inet filter protect-RE-private term bgp-in from port bgp
set logical-systems PE10 firewall family inet filter protect-RE-private term bgp-in then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term traceroute-in from source-prefix-list inet:internal-prefix
set logical-systems PE10 firewall family inet filter protect-RE-private term traceroute-in from protocol udp
set logical-systems PE10 firewall family inet filter protect-RE-private term traceroute-in from destination-port 33434-33523
set logical-systems PE10 firewall family inet filter protect-RE-private term traceroute-in then policer 10m-policer
set logical-systems PE10 firewall family inet filter protect-RE-private term traceroute-in then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term bfd-in from source-prefix-list inet:bgp-prefix
set logical-systems PE10 firewall family inet filter protect-RE-private term bfd-in from protocol udp
set logical-systems PE10 firewall family inet filter protect-RE-private term bfd-in from destination-port 3784
set logical-systems PE10 firewall family inet filter protect-RE-private term bfd-in then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term icmp-limit from source-prefix-list inet:internal-prefix
set logical-systems PE10 firewall family inet filter protect-RE-private term icmp-limit from protocol icmp
set logical-systems PE10 firewall family inet filter protect-RE-private term icmp-limit then policer 10m-policer
set logical-systems PE10 firewall family inet filter protect-RE-private term icmp-limit then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term ntp-in from source-prefix-list inet:ntp-server
set logical-systems PE10 firewall family inet filter protect-RE-private term ntp-in from protocol udp
set logical-systems PE10 firewall family inet filter protect-RE-private term ntp-in from port ntp
set logical-systems PE10 firewall family inet filter protect-RE-private term ntp-in then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term tacacs-reply from source-prefix-list inet:tacacs-servers
set logical-systems PE10 firewall family inet filter protect-RE-private term tacacs-reply from protocol tcp
set logical-systems PE10 firewall family inet filter protect-RE-private term tacacs-reply from source-port 49
set logical-systems PE10 firewall family inet filter protect-RE-private term tacacs-reply then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term dns-reply from source-prefix-list inet:dns-servers
set logical-systems PE10 firewall family inet filter protect-RE-private term dns-reply from protocol udp
set logical-systems PE10 firewall family inet filter protect-RE-private term dns-reply from source-port domain
set logical-systems PE10 firewall family inet filter protect-RE-private term dns-reply then accept
set logical-systems PE10 firewall family inet filter protect-RE-private term discard-last then discard

set logical-systems PE10 firewall family inet filter protect-RE-vpn term first-frag from first-fragment
set logical-systems PE10 firewall family inet filter protect-RE-vpn term first-frag then discard
set logical-systems PE10 firewall family inet filter protect-RE-vpn term next-frag from is-fragment
set logical-systems PE10 firewall family inet filter protect-RE-vpn term next-frag then discard
set logical-systems PE10 firewall family inet filter protect-RE-vpn term traceroute-limit from protocol udp
set logical-systems PE10 firewall family inet filter protect-RE-vpn term traceroute-limit from destination-port 33434-33523
set logical-systems PE10 firewall family inet filter protect-RE-vpn term traceroute-limit then policer 10m-policer
set logical-systems PE10 firewall family inet filter protect-RE-vpn term traceroute-limit then count traceroute-traffic
set logical-systems PE10 firewall family inet filter protect-RE-vpn term traceroute-limit then accept
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit from protocol icmp
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-request
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-reply
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type unreachable
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type time-exceeded
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit then count icmp-traffic
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit then policer 10m-policer
set logical-systems PE10 firewall family inet filter protect-RE-vpn term icmp-limit then accept
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bgp-limit from source-prefix-list RI:bgp-prefix
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bgp-limit from protocol tcp
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bgp-limit from port bgp
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bgp-limit then accept
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bfd-in from source-prefix-list RI:bgp-prefix
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bfd-in from protocol udp
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3784
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3785
set logical-systems PE10 firewall family inet filter protect-RE-vpn term bfd-in then accept
set logical-systems PE10 firewall family inet filter protect-RE-vpn term discard-last then count discard-traffic
set logical-systems PE10 firewall family inet filter protect-RE-vpn term discard-last then discard

set logical-systems PE10 firewall policer 10m-policer if-exceeding bandwidth-limit 10m
set logical-systems PE10 firewall policer 10m-policer if-exceeding burst-size-limit 256k
set logical-systems PE10 firewall policer 10m-policer then discard


	delete groups re-fw logical-systems PE10 interfaces lo0 unit <*> family inet filter input protect-RE-private
	delete logical-systems PE10 apply-groups re-fw
	delete groups vpn-fw logical-systems PE10 interfaces lo0 unit <*> family inet filter input protect-RE-vpn
	delete logical-systems PE10 apply-groups vpn-fw

set logical-systems PE10 policy-options prefix-list inet:snmp-prefix 176.67.173.172/32
set logical-systems PE10 policy-options prefix-list inet:snmp-prefix 69.36.160.0/24
set logical-systems PE10 policy-options prefix-list inet:snmp-prefix 77.92.94.112/28
set logical-systems PE10 policy-options prefix-list inet:snmp-prefix 209.50.158.0/23

set logical-systems PE10 policy-options prefix-list inet:ssh-prefix 77.92.94.112/28
set logical-systems PE10 policy-options prefix-list inet:ssh-prefix 83.170.64.10/32
set logical-systems PE10 policy-options prefix-list inet:ssh-prefix 69.36.160.0/24

set logical-systems PE10 policy-options prefix-list inet:internal-prefix 176.67.173.172/32
set logical-systems PE10 policy-options prefix-list inet:internal-prefix 69.36.160.0/24
set logical-systems PE10 policy-options prefix-list inet:internal-prefix 77.92.94.112/28
set logical-systems PE10 policy-options prefix-list inet:internal-prefix 209.50.158.0/23

set logical-systems PE10 policy-options prefix-list inet:bgp-prefix apply-path "logical-systems PE10 protocols bgp group <*> neighbor <*>"

set logical-systems PE10 policy-options prefix-list inet:radius-servers apply-path "system radius-server <*>"

set logical-systems PE10 policy-options prefix-list inet:tacacs-servers apply-path "system tacplus-server <*>"

set logical-systems PE10 policy-options prefix-list inet:ntp-server apply-path "system ntp server <*>"

set logical-systems PE10 policy-options prefix-list inet:dns-servers apply-path "system name-server <*>"

set logical-systems PE10 policy-options prefix-list RI:bgp-prefix apply-path "logical-systems PE10 protocols bgp group <*> neighbor <*>"






To check the apply paths are working issue the command show policy options prefix-list inet:ntp-server | display inheritance





-----------------------------------------------




set logical-systems PE11 firewall family inet filter protect-RE-private term first-frag from first-fragment
set logical-systems PE11 firewall family inet filter protect-RE-private term first-frag then discard
set logical-systems PE11 firewall family inet filter protect-RE-private term next-frag from is-fragment
set logical-systems PE11 firewall family inet filter protect-RE-private term next-frag then discard
set logical-systems PE11 firewall family inet filter protect-RE-private term ssh-in from source-prefix-list inet:ssh-prefix
set logical-systems PE11 firewall family inet filter protect-RE-private term ssh-in from protocol tcp
set logical-systems PE11 firewall family inet filter protect-RE-private term ssh-in from port ssh
set logical-systems PE11 firewall family inet filter protect-RE-private term ssh-in then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term snmp-limit from source-prefix-list inet:snmp-prefix
set logical-systems PE11 firewall family inet filter protect-RE-private term snmp-limit from protocol udp
set logical-systems PE11 firewall family inet filter protect-RE-private term snmp-limit from port snmp
set logical-systems PE11 firewall family inet filter protect-RE-private term snmp-limit then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term bgp-in from source-prefix-list inet:bgp-prefix
set logical-systems PE11 firewall family inet filter protect-RE-private term bgp-in from protocol tcp
set logical-systems PE11 firewall family inet filter protect-RE-private term bgp-in from port bgp
set logical-systems PE11 firewall family inet filter protect-RE-private term bgp-in then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term traceroute-in from source-prefix-list inet:internal-prefix
set logical-systems PE11 firewall family inet filter protect-RE-private term traceroute-in from protocol udp
set logical-systems PE11 firewall family inet filter protect-RE-private term traceroute-in from destination-port 33434-33523
set logical-systems PE11 firewall family inet filter protect-RE-private term traceroute-in then policer 10m-policer
set logical-systems PE11 firewall family inet filter protect-RE-private term traceroute-in then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term bfd-in from source-prefix-list inet:bgp-prefix
set logical-systems PE11 firewall family inet filter protect-RE-private term bfd-in from protocol udp
set logical-systems PE11 firewall family inet filter protect-RE-private term bfd-in from destination-port 3784
set logical-systems PE11 firewall family inet filter protect-RE-private term bfd-in then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term icmp-limit from source-prefix-list inet:internal-prefix
set logical-systems PE11 firewall family inet filter protect-RE-private term icmp-limit from protocol icmp
set logical-systems PE11 firewall family inet filter protect-RE-private term icmp-limit then policer 10m-policer
set logical-systems PE11 firewall family inet filter protect-RE-private term icmp-limit then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term ntp-in from source-prefix-list inet:ntp-server
set logical-systems PE11 firewall family inet filter protect-RE-private term ntp-in from protocol udp
set logical-systems PE11 firewall family inet filter protect-RE-private term ntp-in from port ntp
set logical-systems PE11 firewall family inet filter protect-RE-private term ntp-in then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term tacacs-reply from source-prefix-list inet:tacacs-servers
set logical-systems PE11 firewall family inet filter protect-RE-private term tacacs-reply from protocol tcp
set logical-systems PE11 firewall family inet filter protect-RE-private term tacacs-reply from source-port 49
set logical-systems PE11 firewall family inet filter protect-RE-private term tacacs-reply then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term dns-reply from source-prefix-list inet:dns-servers
set logical-systems PE11 firewall family inet filter protect-RE-private term dns-reply from protocol udp
set logical-systems PE11 firewall family inet filter protect-RE-private term dns-reply from source-port domain
set logical-systems PE11 firewall family inet filter protect-RE-private term dns-reply then accept
set logical-systems PE11 firewall family inet filter protect-RE-private term discard-last then discard

set logical-systems PE11 firewall family inet filter protect-RE-vpn term first-frag from first-fragment
set logical-systems PE11 firewall family inet filter protect-RE-vpn term first-frag then discard
set logical-systems PE11 firewall family inet filter protect-RE-vpn term next-frag from is-fragment
set logical-systems PE11 firewall family inet filter protect-RE-vpn term next-frag then discard
set logical-systems PE11 firewall family inet filter protect-RE-vpn term traceroute-limit from protocol udp
set logical-systems PE11 firewall family inet filter protect-RE-vpn term traceroute-limit from destination-port 33434-33523
set logical-systems PE11 firewall family inet filter protect-RE-vpn term traceroute-limit then policer 10m-policer
set logical-systems PE11 firewall family inet filter protect-RE-vpn term traceroute-limit then count traceroute-traffic
set logical-systems PE11 firewall family inet filter protect-RE-vpn term traceroute-limit then accept
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit from protocol icmp
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-request
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-reply
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type unreachable
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type time-exceeded
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit then count icmp-traffic
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit then policer 10m-policer
set logical-systems PE11 firewall family inet filter protect-RE-vpn term icmp-limit then accept
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bgp-limit from source-prefix-list RI:bgp-prefix
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bgp-limit from protocol tcp
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bgp-limit from port bgp
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bgp-limit then accept
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bfd-in from source-prefix-list RI:bgp-prefix
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bfd-in from protocol udp
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3784
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3785
set logical-systems PE11 firewall family inet filter protect-RE-vpn term bfd-in then accept
set logical-systems PE11 firewall family inet filter protect-RE-vpn term discard-last then count discard-traffic
set logical-systems PE11 firewall family inet filter protect-RE-vpn term discard-last then discard

set logical-systems PE11 firewall policer 10m-policer if-exceeding bandwidth-limit 10m
set logical-systems PE11 firewall policer 10m-policer if-exceeding burst-size-limit 256k
set logical-systems PE11 firewall policer 10m-policer then discard




	delete groups re-fw logical-systems PE11 interfaces lo0 unit <*> family inet filter input protect-RE-private
	delete logical-systems PE11 apply-groups re-fw
	delete groups vpn-fw logical-systems PE11 interfaces lo0 unit <*> family inet filter input protect-RE-vpn
	delete logical-systems PE11 apply-groups vpn-fw


set logical-systems PE11 policy-options prefix-list inet:snmp-prefix 176.67.173.172/32
set logical-systems PE11 policy-options prefix-list inet:snmp-prefix 69.36.160.0/24
set logical-systems PE11 policy-options prefix-list inet:snmp-prefix 77.92.94.112/28
set logical-systems PE11 policy-options prefix-list inet:snmp-prefix 209.50.158.0/23

set logical-systems PE11 policy-options prefix-list inet:ssh-prefix 77.92.94.112/28
set logical-systems PE11 policy-options prefix-list inet:ssh-prefix 83.170.64.10/32
set logical-systems PE11 policy-options prefix-list inet:ssh-prefix 69.36.160.0/24

set logical-systems PE11 policy-options prefix-list inet:internal-prefix 176.67.173.172/32
set logical-systems PE11 policy-options prefix-list inet:internal-prefix 69.36.160.0/24
set logical-systems PE11 policy-options prefix-list inet:internal-prefix 77.92.94.112/28
set logical-systems PE11 policy-options prefix-list inet:internal-prefix 209.50.158.0/23

set logical-systems PE11 policy-options prefix-list inet:bgp-prefix apply-path "logical-systems PE11 protocols bgp group <*> neighbor <*>"

set logical-systems PE11 policy-options prefix-list inet:radius-servers apply-path "system radius-server <*>"

set logical-systems PE11 policy-options prefix-list inet:tacacs-servers apply-path "system tacplus-server <*>"

set logical-systems PE11 policy-options prefix-list inet:ntp-server apply-path "system ntp server <*>"

set logical-systems PE11 policy-options prefix-list inet:dns-servers apply-path "system name-server <*>"

set logical-systems PE11 policy-options prefix-list RI:bgp-prefix apply-path "logical-systems PE11 protocols bgp group <*> neighbor <*>"






To check the apply paths are working issue the command show policy options prefix-list inet:ntp-server | display inheritance






set logical-systems PE12 firewall family inet filter protect-RE-private term first-frag from first-fragment
set logical-systems PE12 firewall family inet filter protect-RE-private term first-frag then discard
set logical-systems PE12 firewall family inet filter protect-RE-private term next-frag from is-fragment
set logical-systems PE12 firewall family inet filter protect-RE-private term next-frag then discard
set logical-systems PE12 firewall family inet filter protect-RE-private term ssh-in from source-prefix-list inet:ssh-prefix
set logical-systems PE12 firewall family inet filter protect-RE-private term ssh-in from protocol tcp
set logical-systems PE12 firewall family inet filter protect-RE-private term ssh-in from port ssh
set logical-systems PE12 firewall family inet filter protect-RE-private term ssh-in then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term snmp-limit from source-prefix-list inet:snmp-prefix
set logical-systems PE12 firewall family inet filter protect-RE-private term snmp-limit from protocol udp
set logical-systems PE12 firewall family inet filter protect-RE-private term snmp-limit from port snmp
set logical-systems PE12 firewall family inet filter protect-RE-private term snmp-limit then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term bgp-in from source-prefix-list inet:bgp-prefix
set logical-systems PE12 firewall family inet filter protect-RE-private term bgp-in from protocol tcp
set logical-systems PE12 firewall family inet filter protect-RE-private term bgp-in from port bgp
set logical-systems PE12 firewall family inet filter protect-RE-private term bgp-in then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term traceroute-in from source-prefix-list inet:internal-prefix
set logical-systems PE12 firewall family inet filter protect-RE-private term traceroute-in from protocol udp
set logical-systems PE12 firewall family inet filter protect-RE-private term traceroute-in from destination-port 33434-33523
set logical-systems PE12 firewall family inet filter protect-RE-private term traceroute-in then policer 10m-policer
set logical-systems PE12 firewall family inet filter protect-RE-private term traceroute-in then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term bfd-in from source-prefix-list inet:bgp-prefix
set logical-systems PE12 firewall family inet filter protect-RE-private term bfd-in from protocol udp
set logical-systems PE12 firewall family inet filter protect-RE-private term bfd-in from destination-port 3784
set logical-systems PE12 firewall family inet filter protect-RE-private term bfd-in then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term icmp-limit from source-prefix-list inet:internal-prefix
set logical-systems PE12 firewall family inet filter protect-RE-private term icmp-limit from protocol icmp
set logical-systems PE12 firewall family inet filter protect-RE-private term icmp-limit then policer 10m-policer
set logical-systems PE12 firewall family inet filter protect-RE-private term icmp-limit then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term ntp-in from source-prefix-list inet:ntp-server
set logical-systems PE12 firewall family inet filter protect-RE-private term ntp-in from protocol udp
set logical-systems PE12 firewall family inet filter protect-RE-private term ntp-in from port ntp
set logical-systems PE12 firewall family inet filter protect-RE-private term ntp-in then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term tacacs-reply from source-prefix-list inet:tacacs-servers
set logical-systems PE12 firewall family inet filter protect-RE-private term tacacs-reply from protocol tcp
set logical-systems PE12 firewall family inet filter protect-RE-private term tacacs-reply from source-port 49
set logical-systems PE12 firewall family inet filter protect-RE-private term tacacs-reply then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term dns-reply from source-prefix-list inet:dns-servers
set logical-systems PE12 firewall family inet filter protect-RE-private term dns-reply from protocol udp
set logical-systems PE12 firewall family inet filter protect-RE-private term dns-reply from source-port domain
set logical-systems PE12 firewall family inet filter protect-RE-private term dns-reply then accept
set logical-systems PE12 firewall family inet filter protect-RE-private term discard-last then discard

set logical-systems PE12 firewall family inet filter protect-RE-vpn term first-frag from first-fragment
set logical-systems PE12 firewall family inet filter protect-RE-vpn term first-frag then discard
set logical-systems PE12 firewall family inet filter protect-RE-vpn term next-frag from is-fragment
set logical-systems PE12 firewall family inet filter protect-RE-vpn term next-frag then discard
set logical-systems PE12 firewall family inet filter protect-RE-vpn term traceroute-limit from protocol udp
set logical-systems PE12 firewall family inet filter protect-RE-vpn term traceroute-limit from destination-port 33434-33523
set logical-systems PE12 firewall family inet filter protect-RE-vpn term traceroute-limit then policer 10m-policer
set logical-systems PE12 firewall family inet filter protect-RE-vpn term traceroute-limit then count traceroute-traffic
set logical-systems PE12 firewall family inet filter protect-RE-vpn term traceroute-limit then accept
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit from protocol icmp
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-request
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type echo-reply
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type unreachable
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit from icmp-type time-exceeded
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit then count icmp-traffic
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit then policer 10m-policer
set logical-systems PE12 firewall family inet filter protect-RE-vpn term icmp-limit then accept
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bgp-limit from source-prefix-list RI:bgp-prefix
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bgp-limit from protocol tcp
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bgp-limit from port bgp
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bgp-limit then accept
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bfd-in from source-prefix-list RI:bgp-prefix
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bfd-in from protocol udp
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3784
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bfd-in from destination-port 3785
set logical-systems PE12 firewall family inet filter protect-RE-vpn term bfd-in then accept
set logical-systems PE12 firewall family inet filter protect-RE-vpn term discard-last then count discard-traffic
set logical-systems PE12 firewall family inet filter protect-RE-vpn term discard-last then discard

set logical-systems PE12 firewall policer 10m-policer if-exceeding bandwidth-limit 10m
set logical-systems PE12 firewall policer 10m-policer if-exceeding burst-size-limit 256k
set logical-systems PE12 firewall policer 10m-policer then discard



	delete groups re-fw logical-systems PE12 interfaces lo0 unit <*> family inet filter input protect-RE-private
	delete logical-systems PE12 apply-groups re-fw
	delete groups vpn-fw logical-systems PE12 interfaces lo0 unit <*> family inet filter input protect-RE-vpn
	delete logical-systems PE12 apply-groups vpn-fw

set logical-systems PE12 policy-options prefix-list inet:snmp-prefix 176.67.173.172/32
set logical-systems PE12 policy-options prefix-list inet:snmp-prefix 69.36.160.0/24
set logical-systems PE12 policy-options prefix-list inet:snmp-prefix 77.92.94.112/28
set logical-systems PE12 policy-options prefix-list inet:snmp-prefix 209.50.158.0/23

set logical-systems PE12 policy-options prefix-list inet:ssh-prefix 77.92.94.112/28
set logical-systems PE12 policy-options prefix-list inet:ssh-prefix 83.170.64.10/32
set logical-systems PE12 policy-options prefix-list inet:ssh-prefix 69.36.160.0/24

set logical-systems PE12 policy-options prefix-list inet:internal-prefix 176.67.173.172/32
set logical-systems PE12 policy-options prefix-list inet:internal-prefix 69.36.160.0/24
set logical-systems PE12 policy-options prefix-list inet:internal-prefix 77.92.94.112/28
set logical-systems PE12 policy-options prefix-list inet:internal-prefix 209.50.158.0/23

set logical-systems PE12 policy-options prefix-list inet:bgp-prefix apply-path "logical-systems PE12 protocols bgp group <*> neighbor <*>"

set logical-systems PE12 policy-options prefix-list inet:radius-servers apply-path "system radius-server <*>"

set logical-systems PE12 policy-options prefix-list inet:tacacs-servers apply-path "system tacplus-server <*>"

set logical-systems PE12 policy-options prefix-list inet:ntp-server apply-path "system ntp server <*>"

set logical-systems PE12 policy-options prefix-list inet:dns-servers apply-path "system name-server <*>"

set logical-systems PE12 policy-options prefix-list RI:bgp-prefix apply-path "logical-systems PE12 protocols bgp group <*> neighbor <*>"






To check the apply paths are working issue the command show policy options prefix-list inet:ntp-server | display inheritance






*****************************************************************
set chassis fpc 0 pic 0 tunnel-services bandwidth 1g

======
PE7
======


set logical-systems PE7 interfaces ge-0/0/1 unit 0 description "Link to vMX-1 / Logical PE-2"
set logical-systems PE7 interfaces ge-0/0/1 unit 0 family inet address 10.100.1.3/31
set logical-systems PE7 interfaces ge-0/0/1 unit 0 family iso
set logical-systems PE7 interfaces ge-0/0/1 unit 0 family mpls

set logical-systems PE7 interfaces ge-0/0/2 unit 0 description "Link to vMX-3 / Logical PE-13"
set logical-systems PE7 interfaces ge-0/0/2 unit 0 family inet address 10.100.2.2/31
set logical-systems PE7 interfaces ge-0/0/2 unit 0 family iso
set logical-systems PE7 interfaces ge-0/0/2 unit 0 family mpls





set logical-systems PE7 interfaces lo0.7 family inet address 10.2.0.7
set logical-systems PE7 interfaces lo0.7 family iso address 49.0002.0010.0002.0007.00
set logical-systems PE7 protocols isis interface lo0.7 passive
set logical-systems PE7 protocols isis interface lt-0/0/10.14 level 2 disable
delete logical-systems PE7 protocols isis interface lt-0/0/10.3 level 2 disable
delete logical-systems PE7 protocols isis interface lt-0/0/10.3 level 1 disable
set logical-systems PE7 protocols isis interface lt-0/0/10.14 point-to-point
set logical-systems PE7 protocols isis interface lt-0/0/10.3 point-to-point
set logical-systems PE7 protocols isis ignore-attached-bit
set logical-systems PE7 protocols isis level 1 wide-metrics-only
set logical-systems PE7 protocols isis level 2 wide-metrics-only
set logical-systems PE7 protocols isis ignore-attached-bit
set logical-systems PE7 protocols isis interface ge-0/0/1.0 point-to-point
set logical-systems PE7 protocols isis interface ge-0/0/1.0 level 1 disable
set logical-systems PE7 protocols isis interface ge-0/0/2.0 point-to-point
set logical-systems PE7 protocols isis interface ge-0/0/2.0 level 1 disable




set logical-systems PE7 interfaces lt-0/0/10 unit 14 encapsulation vlan
set logical-systems PE7 interfaces lt-0/0/10 unit 14 vlan-id 2
set logical-systems PE7 interfaces lt-0/0/10 unit 14 description "Link to PE9"
set logical-systems PE7 interfaces lt-0/0/10 unit 14 peer-unit 13
set logical-systems PE7 interfaces lt-0/0/10 unit 14 family inet address 10.20.6.1/31
set logical-systems PE7 interfaces lt-0/0/10 unit 14 family iso






set logical-systems PE7 interfaces lt-0/0/10 unit 3 encapsulation vlan
set logical-systems PE7 interfaces lt-0/0/10 unit 3 vlan-id 2
set logical-systems PE7 interfaces lt-0/0/10 unit 3 description "Link to PE8"
set logical-systems PE7 interfaces lt-0/0/10 unit 3 peer-unit 4
set logical-systems PE7 interfaces lt-0/0/10 unit 3 family inet address 10.20.1.0/31
set logical-systems PE7 interfaces lt-0/0/10 unit 3 family iso



delete logical-systems PE7 protocols isis level 1 preference 6
delete logical-systems PE7 protocols isis level 2 preference 6


delete logical-systems PE8 protocols isis level 1 preference 6
delete logical-systems PE8 protocols isis level 2 preference 6
======
PE8
======

set logical-systems PE8 interfaces ge-0/0/0 unit 0 description "Link to vMX-1 / Logical PE-1"
set logical-systems PE8 interfaces ge-0/0/0 unit 0 family inet address 10.100.1.1/31
set logical-systems PE8 interfaces ge-0/0/0 unit 0 family iso
set logical-systems PE8 interfaces ge-0/0/0 unit 0 family mpls


set logical-systems PE8 interfaces ge-0/0/3 unit 0 description "Link to vMX-3 / Logical PE-13"
set logical-systems PE8 interfaces ge-0/0/3 unit 0 family inet address 10.100.2.1/31
set logical-systems PE8 interfaces ge-0/0/3 unit 0 family iso
set logical-systems PE8 interfaces ge-0/0/3 unit 0 family mpls


set logical-systems PE8 interfaces lo0.8 family inet address 10.2.0.8
set logical-systems PE8 interfaces lo0.8 family iso address 49.0002.0010.0002.0008.00
set logical-systems PE8 protocols isis interface lo0.8 passive
delete logical-systems PE8 protocols isis interface lt-0/0/10.4 level 2 disable
delete logical-systems PE8 protocols isis interface lt-0/0/10.4 level 1 disable
set logical-systems PE8 protocols isis interface lt-0/0/10.5 level 2 disable
set logical-systems PE8 protocols isis interface lt-0/0/10.4 point-to-point
set logical-systems PE8 protocols isis interface lt-0/0/10.5 point-to-point
set logical-systems PE8 protocols isis ignore-attached-bit
set logical-systems PE8 protocols isis level 1 wide-metrics-only
set logical-systems PE8 protocols isis level 2 wide-metrics-only
set logical-systems PE8 protocols isis ignore-attached-bit
set logical-systems PE8 protocols isis interface ge-0/0/3.0 point-to-point
set logical-systems PE8 protocols isis interface ge-0/0/3.0 level 1 disable

set logical-systems PE8 protocols isis interface ge-0/0/0.0 point-to-point
set logical-systems PE8 protocols isis interface ge-0/0/0.0 level 1 disable



set logical-systems PE8 interfaces lt-0/0/10 unit 4 encapsulation vlan
set logical-systems PE8 interfaces lt-0/0/10 unit 4 vlan-id 2
set logical-systems PE8 interfaces lt-0/0/10 unit 4 description "Link to PE7"
set logical-systems PE8 interfaces lt-0/0/10 unit 4 peer-unit 3
set logical-systems PE8 interfaces lt-0/0/10 unit 4 family inet address 10.20.1.1/31
set logical-systems PE8 interfaces lt-0/0/10 unit 4 family iso

set logical-systems PE8 interfaces lt-0/0/10 unit 5 encapsulation vlan
set logical-systems PE8 interfaces lt-0/0/10 unit 5 vlan-id 2
set logical-systems PE8 interfaces lt-0/0/10 unit 5 description "Link to PE10"
set logical-systems PE8 interfaces lt-0/0/10 unit 5 peer-unit 6
set logical-systems PE8 interfaces lt-0/0/10 unit 5 family inet address 10.20.2.0/31
set logical-systems PE8 interfaces lt-0/0/10 unit 5 family iso


======
PE10
======


set logical-systems PE10 interfaces lo0.10 family inet address 10.2.0.10
set logical-systems PE10 interfaces lo0.10 family iso address 49.0002.0010.0002.0010.00
set logical-systems PE10 protocols isis interface lo0.10 passive
set logical-systems PE10 protocols isis interface lt-0/0/10.6 level 2 disable
set logical-systems PE10 protocols isis interface lt-0/0/10.7 level 2 disable
set logical-systems PE10 protocols isis interface lt-0/0/10.6 point-to-point
set logical-systems PE10 protocols isis interface lt-0/0/10.7 point-to-point

set logical-systems PE10 protocols isis interface lt-0/0/10.16 level 2 disable
set logical-systems PE10 protocols isis interface lt-0/0/10.16 point-to-point
set logical-systems PE10 protocols isis ignore-attached-bit
set logical-systems PE10 protocols isis level 1 wide-metrics-only


set logical-systems PE10 interfaces lt-0/0/10 unit 6 encapsulation vlan
set logical-systems PE10 interfaces lt-0/0/10 unit 6 vlan-id 2
set logical-systems PE10 interfaces lt-0/0/10 unit 6 description "Link to PE8"
set logical-systems PE10 interfaces lt-0/0/10 unit 6 peer-unit 5
set logical-systems PE10 interfaces lt-0/0/10 unit 6 family inet address 10.20.2.1/31
set logical-systems PE10 interfaces lt-0/0/10 unit 6 family iso


set logical-systems PE10 interfaces lt-0/0/10 unit 7 encapsulation vlan
set logical-systems PE10 interfaces lt-0/0/10 unit 7 vlan-id 2
set logical-systems PE10 interfaces lt-0/0/10 unit 7 description "Link to PE12"
set logical-systems PE10 interfaces lt-0/0/10 unit 7 peer-unit 8
set logical-systems PE10 interfaces lt-0/0/10 unit 7 family inet address 10.20.3.0/31
set logical-systems PE10 interfaces lt-0/0/10 unit 7 family iso


set logical-systems PE10 interfaces lt-0/0/10 unit 16 encapsulation vlan
set logical-systems PE10 interfaces lt-0/0/10 unit 16 vlan-id 2
set logical-systems PE10 interfaces lt-0/0/10 unit 16 description "Link to PE9"
set logical-systems PE10 interfaces lt-0/0/10 unit 16 peer-unit 15
set logical-systems PE10 interfaces lt-0/0/10 unit 16 family inet address 10.20.7.1/31
set logical-systems PE10 interfaces lt-0/0/10 unit 16 family iso



======
PE12
======


set logical-systems PE12 interfaces lo0.12 family inet address 10.2.0.12
set logical-systems PE12 interfaces lo0.12 family iso address 49.0002.0010.0002.0012.00
set logical-systems PE12 protocols isis interface lo0.12 passive
set logical-systems PE12 protocols isis interface lt-0/0/10.8 level 2 disable
set logical-systems PE12 protocols isis interface lt-0/0/10.9 level 2 disable
set logical-systems PE12 protocols isis interface lt-0/0/10.8 point-to-point
set logical-systems PE12 protocols isis interface lt-0/0/10.9 point-to-point
set logical-systems PE12 protocols isis ignore-attached-bit
set logical-systems PE12 protocols isis level 1 wide-metrics-only



set logical-systems PE12 interfaces lt-0/0/10 unit 8 encapsulation vlan
set logical-systems PE12 interfaces lt-0/0/10 unit 8 vlan-id 2
set logical-systems PE12 interfaces lt-0/0/10 unit 8 description "Link to PE10"
set logical-systems PE12 interfaces lt-0/0/10 unit 8 peer-unit 7
set logical-systems PE12 interfaces lt-0/0/10 unit 8 family inet address 10.20.3.1/31
set logical-systems PE12 interfaces lt-0/0/10 unit 8 family iso


set logical-systems PE12 interfaces lt-0/0/10 unit 9 encapsulation vlan
set logical-systems PE12 interfaces lt-0/0/10 unit 9 vlan-id 2
set logical-systems PE12 interfaces lt-0/0/10 unit 9 description "Link to PE11"
set logical-systems PE12 interfaces lt-0/0/10 unit 9 peer-unit 10
set logical-systems PE12 interfaces lt-0/0/10 unit 9 family inet address 10.20.4.0/31
set logical-systems PE12 interfaces lt-0/0/10 unit 9 family iso



======
PE11
======

set logical-systems PE11 interfaces lo0.11 family inet address 10.2.0.11
set logical-systems PE11 interfaces lo0.11 family iso address 49.0002.0010.0002.0011.00
set logical-systems PE11 protocols isis interface lo0.11 passive
set logical-systems PE11 protocols isis interface lt-0/0/10.10 level 2 disable
set logical-systems PE11 protocols isis interface lt-0/0/10.11 level 2 disable
set logical-systems PE11 protocols isis interface lt-0/0/10.10 point-to-point
set logical-systems PE11 protocols isis interface lt-0/0/10.11 point-to-point
set logical-systems PE11 protocols isis ignore-attached-bit
set logical-systems PE11 protocols isis level 1 wide-metrics-only

set logical-systems PE11 interfaces lt-0/0/10 unit 10 encapsulation vlan
set logical-systems PE11 interfaces lt-0/0/10 unit 10 vlan-id 2
set logical-systems PE11 interfaces lt-0/0/10 unit 10 description "Link to PE12"
set logical-systems PE11 interfaces lt-0/0/10 unit 10 peer-unit 9
set logical-systems PE11 interfaces lt-0/0/10 unit 10 family inet address 10.20.4.1/31
set logical-systems PE11 interfaces lt-0/0/10 unit 10 family iso


set logical-systems PE11 interfaces lt-0/0/10 unit 11 encapsulation vlan
set logical-systems PE11 interfaces lt-0/0/10 unit 11 vlan-id 2
set logical-systems PE11 interfaces lt-0/0/10 unit 11 description "Link to PE9"
set logical-systems PE11 interfaces lt-0/0/10 unit 11 peer-unit 12
set logical-systems PE11 interfaces lt-0/0/10 unit 11 family inet address 10.20.5.0/31
set logical-systems PE11 interfaces lt-0/0/10 unit 11 family iso




======
PE9
======

delete logical-systems PE9 interfaces ge-0/0/0
#set logical-systems PE9 interfaces ge-0/0/0 unit 0 description "Link to vMX-1 / Logical PE-4"
#set logical-systems PE9 interfaces ge-0/0/0 unit 0 family inet address 10.100.1.1/31
#set logical-systems PE9 interfaces ge-0/0/0 unit 0 family iso

set logical-systems PE9 interfaces lo0.9 family inet address 10.2.0.9
set logical-systems PE9 interfaces lo0.9 family iso address 49.0002.0010.0002.0009.00
set logical-systems PE9 protocols isis interface lo0.9 passive
set logical-systems PE9 protocols isis interface lt-0/0/10.12 level 2 disable
set logical-systems PE9 protocols isis interface lt-0/0/10.13 level 2 disable
set logical-systems PE9 protocols isis interface lt-0/0/10.12 point-to-point
set logical-systems PE9 protocols isis interface lt-0/0/10.13 point-to-point

set logical-systems PE9 protocols isis interface lt-0/0/10.15 level 2 disable
set logical-systems PE9 protocols isis interface lt-0/0/10.15 point-to-point

set logical-systems PE9 protocols isis ignore-attached-bit
set logical-systems PE9 protocols isis level 1 wide-metrics-only
set logical-systems PE9 protocols isis level 2 wide-metrics-only
set logical-systems PE9 protocols isis ignore-attached-bit
#set logical-systems PE9 protocols isis interface ge-0/0/0.0 point-to-point
#set logical-systems PE9 protocols isis interface ge-0/0/0.0 level 1 disable

set logical-systems PE9 interfaces lt-0/0/10 unit 12 encapsulation vlan
set logical-systems PE9 interfaces lt-0/0/10 unit 12 vlan-id 2
set logical-systems PE9 interfaces lt-0/0/10 unit 12 description "Link to PE11"
set logical-systems PE9 interfaces lt-0/0/10 unit 12 peer-unit 11
set logical-systems PE9 interfaces lt-0/0/10 unit 12 family inet address 10.20.5.1/31
set logical-systems PE9 interfaces lt-0/0/10 unit 12 family iso


set logical-systems PE9 interfaces lt-0/0/10 unit 13 encapsulation vlan
set logical-systems PE9 interfaces lt-0/0/10 unit 13 vlan-id 2
set logical-systems PE9 interfaces lt-0/0/10 unit 13 description "Link to PE7"
set logical-systems PE9 interfaces lt-0/0/10 unit 13 peer-unit 14
set logical-systems PE9 interfaces lt-0/0/10 unit 13 family inet address 10.20.6.0/31
set logical-systems PE9 interfaces lt-0/0/10 unit 13 family iso




set logical-systems PE9 interfaces lt-0/0/10 unit 15 encapsulation vlan
set logical-systems PE9 interfaces lt-0/0/10 unit 15 vlan-id 2
set logical-systems PE9 interfaces lt-0/0/10 unit 15 description "Link to PE10"
set logical-systems PE9 interfaces lt-0/0/10 unit 15 peer-unit 16
set logical-systems PE9 interfaces lt-0/0/10 unit 15 family inet address 10.20.7.0/31
set logical-systems PE9 interfaces lt-0/0/10 unit 15 family iso



- ISIS route supress:




set logical-systems PE7 policy-options policy-statement suppress-link-subnets from route-filter 10.20.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement suppress-link-subnets from route-filter 10.100.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement suppress-link-subnets then reject
set logical-systems PE7 protocols isis import suppress-link-subnets
set logical-systems PE7 protocols isis export suppress-link-subnets

set logical-systems PE8 policy-options policy-statement suppress-link-subnets from route-filter 10.20.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement suppress-link-subnets from route-filter 10.100.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement suppress-link-subnets then reject
set logical-systems PE8 protocols isis import suppress-link-subnets
set logical-systems PE8 protocols isis export suppress-link-subnets

set logical-systems PE9 policy-options policy-statement suppress-link-subnets from route-filter 10.20.0.0/16 orlonger
set logical-systems PE9 policy-options policy-statement suppress-link-subnets from route-filter 10.100.0.0/16 orlonger
set logical-systems PE9 policy-options policy-statement suppress-link-subnets then reject
set logical-systems PE9 protocols isis import suppress-link-subnets
set logical-systems PE9 protocols isis export suppress-link-subnets


set logical-systems PE10 policy-options policy-statement suppress-link-subnets from route-filter 10.20.0.0/16 orlonger
set logical-systems PE10 policy-options policy-statement suppress-link-subnets from route-filter 10.100.0.0/16 orlonger
set logical-systems PE10 policy-options policy-statement suppress-link-subnets then reject
set logical-systems PE10 protocols isis import suppress-link-subnets
set logical-systems PE10 protocols isis export suppress-link-subnets

set logical-systems PE11 policy-options policy-statement suppress-link-subnets from route-filter 10.20.0.0/16 orlonger
set logical-systems PE11 policy-options policy-statement suppress-link-subnets from route-filter 10.100.0.0/16 orlonger
set logical-systems PE11 policy-options policy-statement suppress-link-subnets then reject
set logical-systems PE11 protocols isis import suppress-link-subnets
set logical-systems PE11 protocols isis export suppress-link-subnets

set logical-systems PE12 policy-options policy-statement suppress-link-subnets from route-filter 10.20.0.0/16 orlonger
set logical-systems PE12 policy-options policy-statement suppress-link-subnets from route-filter 10.100.0.0/16 orlonger
set logical-systems PE12 policy-options policy-statement suppress-link-subnets then reject
set logical-systems PE12 protocols isis import suppress-link-subnets
set logical-systems PE12 protocols isis export suppress-link-subnets





***************************************************************

						LDP CONFIG

***************************************************************


vMX2:
set logical-systems PE7 protocols ldp interface ge-0/0/1.0
set logical-systems PE7 protocols ldp interface ge-0/0/2.0


set logical-systems PE8 protocols ldp interface ge-0/0/0.0
set logical-systems PE8 protocols ldp interface ge-0/0/3.0


***************************************************************

						RSVP CONFIG

***************************************************************




======
PE7
======
set groups GR-LSP logical-systems PE7 protocols mpls label-switched-path <*> adaptive


delete logical-systems PE7 protocols mpls

set logical-systems PE7 protocols mpls apply-groups GR-LSP
set logical-systems PE7 protocols mpls optimize-timer 1800
set logical-systems PE7 protocols mpls optimize-switchover-delay 180



set logical-systems PE7 protocols mpls ipv6-tunneling
set logical-systems PE7 protocols mpls traffic-engineering
delete logical-systems PE7 protocols mpls no-propagate-ttl

set logical-systems PE7 protocols mpls traffic-engineering bgp-igp-both-ribs



set logical-systems PE7 protocols mpls interface all
set logical-systems PE7 protocols rsvp interface lt-0/0/10.14
set logical-systems PE7 protocols rsvp interface lt-0/0/10.3
set logical-systems PE7 interfaces lt-0/0/10 unit 14 family mpls
set logical-systems PE7 interfaces lt-0/0/10 unit 3 family mpls
set logical-systems PE7 interfaces ge-0/0/1 unit 0 family mpls
set logical-systems PE7 interfaces ge-0/0/2 unit 0 family mpls


delete logical-systems PE7 protocols mpls label-switched-path PE7-to-PE8
delete logical-systems PE7 protocols mpls label-switched-path PE7-to-PE9
delete logical-systems PE7 protocols mpls label-switched-path PE7-to-PE10
delete logical-systems PE7 protocols mpls label-switched-path PE7-to-PE11
delete logical-systems PE7 protocols mpls label-switched-path PE7-to-PE12



---

set logical-systems PE7 protocols mpls interface lt-0/0/10.3 admin-group gold
set logical-systems PE7 protocols mpls interface lt-0/0/10.3 admin-group silver
delete logical-systems PE7 protocols mpls interface lt-0/0/10.3 admin-group bronze
set logical-systems PE7 protocols mpls interface lt-0/0/10.14 admin-group gold
delete logical-systems PE7 protocols mpls interface lt-0/0/10.14 admin-group bronze


set logical-systems PE7 protocols mpls admin-groups gold 1
set logical-systems PE7 protocols mpls admin-groups silver 2
delete logical-systems PE7 protocols mpls admin-groups bronze 3


set logical-systems PE7 protocols mpls path SECONDARY


set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE8-Gold to 10.2.0.8
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE8-Gold primary path8 admin-group include-any gold

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE8-Gold to 10.2.0.8
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE8-Gold secondary SECONDARY standby

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE9-Gold to 10.2.0.9
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE9-Gold primary path3 admin-group include-any gold

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE9-Gold to 10.2.0.9
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE9-Gold secondary SECONDARY standby

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE10-Gold to 10.2.0.10
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE10-Gold primary path3 admin-group include-any gold

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE10-Gold to 10.2.0.10
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE10-Gold secondary SECONDARY standby

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE11-Gold to 10.2.0.11
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE11-Gold primary path3 admin-group include-any gold

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE11-Gold to 10.2.0.11
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE11-Gold secondary SECONDARY standby

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE12-Gold to 10.2.0.12
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE12-Gold primary path3 admin-group include-any gold

set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE12-Gold to 10.2.0.12
set logical-systems PE7 protocols mpls label-switched-path PE7-to-PE12-Gold secondary SECONDARY standby


set logical-systems PE7 protocols mpls path path7 10.2.0.7 loose
set logical-systems PE7 protocols mpls path path8 10.2.0.8 loose
set logical-systems PE7 protocols mpls path path3 10.2.0.9 loose
set logical-systems PE7 protocols mpls path path10 10.2.0.10 loose
set logical-systems PE7 protocols mpls path path11 10.2.0.11 loose
set logical-systems PE7 protocols mpls path path12 10.2.0.12 loose

----

set logical-systems PE7 protocols mpls traffic-engineering bgp-igp-both-ribs



======
PE8
======

set groups GR-LSP logical-systems PE8 protocols mpls label-switched-path <*> adaptive

delete logical-systems PE8 protocols mpls

set logical-systems PE8 protocols mpls traffic-engineering bgp-igp-both-ribs
set logical-systems PE8 protocols mpls apply-groups GR-LSP
set logical-systems PE8 protocols mpls optimize-timer 1800
set logical-systems PE8 protocols mpls optimize-switchover-delay 180

set logical-systems PE8 protocols mpls ipv6-tunneling
set logical-systems PE8 protocols mpls traffic-engineering
delete logical-systems PE8 protocols mpls no-propagate-ttl
set logical-systems PE8 protocols mpls traffic-engineering bgp-igp-both-ribs



set logical-systems PE8 protocols mpls interface all
set logical-systems PE8 protocols rsvp interface lt-0/0/10.4
set logical-systems PE8 protocols rsvp interface lt-0/0/10.5
set logical-systems PE8 interfaces lt-0/0/10 unit 4 family mpls
set logical-systems PE8 interfaces lt-0/0/10 unit 5 family mpls
set logical-systems PE8 interfaces ge-0/0/3 unit 0 family mpls



delete logical-systems PE8 protocols mpls label-switched-path PE8-to-PE7
delete logical-systems PE8 protocols mpls label-switched-path PE8-to-PE9
delete logical-systems PE8 protocols mpls label-switched-path PE8-to-PE10
delete logical-systems PE8 protocols mpls label-switched-path PE8-to-PE11
delete logical-systems PE8 protocols mpls label-switched-path PE8-to-PE12



set logical-systems PE8 protocols mpls interface lt-0/0/10.4 admin-group gold
set logical-systems PE8 protocols mpls interface lt-0/0/10.4 admin-group silver
delete logical-systems PE8 protocols mpls interface lt-0/0/10.4 admin-group bronze
set logical-systems PE8 protocols mpls interface lt-0/0/10.5 admin-group silver
delete logical-systems PE8 protocols mpls interface lt-0/0/10.5 admin-group bronze
set logical-systems PE8 protocols mpls admin-groups gold 1
set logical-systems PE8 protocols mpls admin-groups silver 2
delete logical-systems PE8 protocols mpls admin-groups bronze 3




set logical-systems PE8 protocols mpls path SECONDARY

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE7-Silver to 10.2.0.7
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE7-Silver primary path7 admin-group include-any silver

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE7-Silver to 10.2.0.7
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE7-Silver secondary SECONDARY standby

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE9-Silver to 10.2.0.9
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE9-Silver primary path10 admin-group include-any silver

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE9-Silver to 10.2.0.9
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE9-Silver secondary SECONDARY standby

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE10-Silver to 10.2.0.10
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE10-Silver primary path10 admin-group include-any silver

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE10-Silver to 10.2.0.10
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE10-Silver secondary SECONDARY standby


set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE11-Silver to 10.2.0.11
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE11-Silver primary path10 admin-group include-any silver

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE11-Silver to 10.2.0.11
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE11-Silver secondary SECONDARY standby


set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE12-Silver to 10.2.0.12
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE12-Silver primary path10 admin-group include-any silver

set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE12-Silver to 10.2.0.12
set logical-systems PE8 protocols mpls label-switched-path PE8-to-PE12-Silver secondary SECONDARY standby



set logical-systems PE8 protocols mpls path path7 10.2.0.7 loose
set logical-systems PE8 protocols mpls path path8 10.2.0.8 loose
set logical-systems PE8 protocols mpls path path3 10.2.0.9 loose
set logical-systems PE8 protocols mpls path path10 10.2.0.10 loose
set logical-systems PE8 protocols mpls path path11 10.2.0.11 loose
set logical-systems PE8 protocols mpls path path12 10.2.0.12 loose



======
PE10
======
set groups GR-LSP logical-systems PE10 protocols mpls label-switched-path <*> adaptive

delete logical-systems PE10 protocols mpls 


set logical-systems PE10 protocols mpls apply-groups GR-LSP
set logical-systems PE10 protocols mpls optimize-timer 1800
set logical-systems PE10 protocols mpls optimize-switchover-delay 180

set logical-systems PE10 protocols mpls ipv6-tunneling
set logical-systems PE10 protocols mpls traffic-engineering
delete logical-systems PE10 protocols mpls no-propagate-ttl


set logical-systems PE10 protocols mpls interface all
set logical-systems PE10 protocols rsvp interface lt-0/0/10.6
set logical-systems PE10 protocols rsvp interface lt-0/0/10.7
set logical-systems PE10 interfaces lt-0/0/10 unit 6 family mpls
set logical-systems PE10 interfaces lt-0/0/10 unit 7 family mpls


set logical-systems PE10 protocols rsvp interface lt-0/0/10.16
set logical-systems PE10 interfaces lt-0/0/10 unit 16 family mpls





set logical-systems PE10 protocols mpls interface lt-0/0/10.6 admin-group silver
delete logical-systems PE10 protocols mpls interface lt-0/0/10.6 admin-group bronze
set logical-systems PE10 protocols mpls interface lt-0/0/10.7 admin-group silver
delete logical-systems PE10 protocols mpls interface lt-0/0/10.7 admin-group bronze
set logical-systems PE10 protocols mpls interface lt-0/0/10.16 admin-group gold
set logical-systems PE10 protocols mpls interface lt-0/0/10.16 admin-group silver
delete logical-systems PE10 protocols mpls interface lt-0/0/10.16 admin-group bronze


set logical-systems PE10 protocols mpls admin-groups gold 1
set logical-systems PE10 protocols mpls admin-groups silver 2
delete logical-systems PE10 protocols mpls admin-groups bronze 3




set logical-systems PE10 protocols mpls path SECONDARY



set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE7-Silver to 10.2.0.7
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE7-Silver primary path8 admin-group include-any silver

set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE7-Silver to 10.2.0.7
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE7-Silver secondary SECONDARY standby


set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE8-Silver to 10.2.0.8
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE8-Silver primary path8 admin-group include-any silver

set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE8-Silver to 10.2.0.8
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE8-Silver secondary SECONDARY standby


set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE9-Silver to 10.2.0.9
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE9-Silver primary path3 admin-group include-any silver

set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE9-Silver to 10.2.0.9
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE9-Silver secondary SECONDARY standby


set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE11-Silver to 10.2.0.11
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE11-Silver primary path12 admin-group include-any silver

set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE11-Silver to 10.2.0.11
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE11-Silver secondary SECONDARY standby


set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE12-Silver to 10.2.0.12
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE12-Silver primary path12 admin-group include-any silver

set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE12-Silver to 10.2.0.12
set logical-systems PE10 protocols mpls label-switched-path PE10-to-PE12-Silver secondary SECONDARY standby



set logical-systems PE10 protocols mpls path path7 10.2.0.7 loose
set logical-systems PE10 protocols mpls path path8 10.2.0.8 loose
set logical-systems PE10 protocols mpls path path3 10.2.0.9 loose
set logical-systems PE10 protocols mpls path path10 10.2.0.10 loose
set logical-systems PE10 protocols mpls path path11 10.2.0.11 loose
set logical-systems PE10 protocols mpls path path12 10.2.0.12 loose




======
PE12
======

set groups GR-LSP logical-systems PE12 protocols mpls label-switched-path <*> adaptive


delete logical-systems PE12 protocols mpls


set logical-systems PE12 protocols mpls apply-groups GR-LSP
set logical-systems PE12 protocols mpls optimize-timer 1800
set logical-systems PE12 protocols mpls optimize-switchover-delay 180

set logical-systems PE12 protocols mpls ipv6-tunneling
set logical-systems PE12 protocols mpls traffic-engineering
delete logical-systems PE12 protocols mpls no-propagate-ttl



set logical-systems PE12 protocols mpls interface all
set logical-systems PE12 protocols rsvp interface lt-0/0/10.8
set logical-systems PE12 protocols rsvp interface lt-0/0/10.9
set logical-systems PE12 interfaces lt-0/0/10 unit 8 family mpls
set logical-systems PE12 interfaces lt-0/0/10 unit 9 family mpls




delete logical-systems PE12 protocols mpls label-switched-path PE12-to-PE7
delete logical-systems PE12 protocols mpls label-switched-path PE12-to-PE8
delete logical-systems PE12 protocols mpls label-switched-path PE12-to-PE9
delete logical-systems PE12 protocols mpls label-switched-path PE12-to-PE10
delete logical-systems PE12 protocols mpls label-switched-path PE12-to-PE11









set logical-systems PE12 protocols mpls interface lt-0/0/10.8 admin-group silver
delete logical-systems PE12 protocols mpls interface lt-0/0/10.8 admin-group bronze
set logical-systems PE12 protocols mpls interface lt-0/0/10.9 admin-group gold
set logical-systems PE12 protocols mpls interface lt-0/0/10.9 admin-group silver
delete logical-systems PE12 protocols mpls interface lt-0/0/10.9 admin-group bronze


set logical-systems PE12 protocols mpls admin-groups gold 1
set logical-systems PE12 protocols mpls admin-groups silver 2
delete logical-systems PE12 protocols mpls admin-groups bronze 3


set logical-systems PE12 protocols mpls path SECONDARY


set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE7-Silver to 10.2.0.7
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE7-Silver primary path8 admin-group include-any silver

set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE7-Silver to 10.2.0.7
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE7-Silver secondary SECONDARY standby


set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE8-Silver to 10.2.0.8
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE8-Silver primary path10 admin-group include-any silver

set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE8-Silver to 10.2.0.8
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE8-Silver secondary SECONDARY standby


set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE9-Silver to 10.2.0.9
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE9-Silver primary path10 admin-group include-any silver

set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE9-Silver to 10.2.0.9
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE9-Silver secondary SECONDARY standby

set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE10-Silver to 10.2.0.10
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE10-Silver primary path10 admin-group include-any silver

set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE10-Silver to 10.2.0.10
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE10-Silver secondary SECONDARY standby

set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE11-Silver to 10.2.0.11
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE11-Silver primary path11 admin-group include-any silver

set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE11-Silver to 10.2.0.11
set logical-systems PE12 protocols mpls label-switched-path PE12-to-PE11-Silver secondary SECONDARY standby





set logical-systems PE12 protocols mpls path path7 10.2.0.7 loose
set logical-systems PE12 protocols mpls path path8 10.2.0.8 loose
set logical-systems PE12 protocols mpls path path3 10.2.0.9 loose
set logical-systems PE12 protocols mpls path path10 10.2.0.10 loose
set logical-systems PE12 protocols mpls path path11 10.2.0.11 loose
set logical-systems PE12 protocols mpls path path12 10.2.0.12 loose



======
PE11
======
set groups GR-LSP logical-systems PE11 protocols mpls label-switched-path <*> adaptive


delete  logical-systems PE11 protocols mpls


set logical-systems PE11 protocols mpls apply-groups GR-LSP
set logical-systems PE11 protocols mpls optimize-timer 1800
set logical-systems PE11 protocols mpls optimize-switchover-delay 180

set logical-systems PE11 protocols mpls ipv6-tunneling
set logical-systems PE11 protocols mpls traffic-engineering
delete logical-systems PE11 protocols mpls no-propagate-ttl

set logical-systems PE11 protocols mpls interface all
set logical-systems PE11 protocols rsvp interface lt-0/0/10.10
set logical-systems PE11 protocols rsvp interface lt-0/0/10.11
set logical-systems PE11 interfaces lt-0/0/10 unit 10 family mpls
set logical-systems PE11 interfaces lt-0/0/10 unit 11 family mpls



set logical-systems PE11 protocols mpls interface lt-0/0/10.10 admin-group gold
set logical-systems PE11 protocols mpls interface lt-0/0/10.10 admin-group silver
delete logical-systems PE11 protocols mpls interface lt-0/0/10.10 admin-group bronze
set logical-systems PE11 protocols mpls interface lt-0/0/10.11 admin-group gold
delete logical-systems PE11 protocols mpls interface lt-0/0/10.11 admin-group bronze
set logical-systems PE11 protocols mpls admin-groups gold 1
set logical-systems PE11 protocols mpls admin-groups silver 2
delete logical-systems PE11 protocols mpls admin-groups bronze 3


set logical-systems PE11 protocols mpls path SECONDARY



set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE7-Gold to 10.2.0.7
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE7-Gold primary path3 admin-group include-any gold

set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE7-Gold to 10.2.0.7
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE7-Gold secondary SECONDARY standby



set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE8-Gold to 10.2.0.8
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE8-Gold primary path7 admin-group include-any gold

set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE8-Gold to 10.2.0.8
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE8-Gold secondary SECONDARY standby

set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE9-Gold to 10.2.0.9
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE9-Gold primary path3 admin-group include-any gold

set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE9-Gold to 10.2.0.9
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE9-Gold secondary SECONDARY standby

set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE10-Gold to 10.2.0.10
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE10-Gold primary path3 admin-group include-any gold

set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE10-Gold to 10.2.0.10
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE10-Gold secondary SECONDARY standby


set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE12-Gold to 10.2.0.12
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE12-Gold primary path12 admin-group include-any gold

set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE12-Gold to 10.2.0.12
set logical-systems PE11 protocols mpls label-switched-path PE11-to-PE12-Gold secondary SECONDARY standby



set logical-systems PE11 protocols mpls path path7 10.2.0.7 loose
set logical-systems PE11 protocols mpls path path8 10.2.0.8 loose
set logical-systems PE11 protocols mpls path path3 10.2.0.9 loose
set logical-systems PE11 protocols mpls path path10 10.2.0.10 loose
set logical-systems PE11 protocols mpls path path11 10.2.0.11 loose
set logical-systems PE11 protocols mpls path path12 10.2.0.12 loose



======
PE9
======

set groups GR-LSP logical-systems PE9 protocols mpls label-switched-path <*> adaptive


delete logical-systems PE9 protocols mpls

set logical-systems PE9 protocols mpls apply-groups GR-LSP
set logical-systems PE9 protocols mpls optimize-timer 1800
set logical-systems PE9 protocols mpls optimize-switchover-delay 180

set logical-systems PE9 protocols mpls ipv6-tunneling
set logical-systems PE9 protocols mpls traffic-engineering
delete logical-systems PE9 protocols mpls no-propagate-ttl


set logical-systems PE9 protocols mpls interface all
set logical-systems PE9 protocols rsvp interface lt-0/0/10.12
set logical-systems PE9 protocols rsvp interface lt-0/0/10.13
set logical-systems PE9 interfaces lt-0/0/10 unit 12 family mpls
set logical-systems PE9 interfaces lt-0/0/10 unit 13 family mpls


set logical-systems PE9 protocols rsvp interface lt-0/0/10.15
set logical-systems PE9 interfaces lt-0/0/10 unit 15 family mpls


delete logical-systems PE9 protocols mpls label-switched-path PE9-to-PE7
delete logical-systems PE9 protocols mpls label-switched-path PE9-to-PE8
delete logical-systems PE9 protocols mpls label-switched-path PE9-to-PE10
delete logical-systems PE9 protocols mpls label-switched-path PE9-to-PE11
delete logical-systems PE9 protocols mpls label-switched-path PE9-to-PE12



set logical-systems PE9 protocols mpls interface lt-0/0/10.12 admin-group gold
delete logical-systems PE9 protocols mpls interface lt-0/0/10.12 admin-group bronze
set logical-systems PE9 protocols mpls interface lt-0/0/10.13 admin-group gold
delete logical-systems PE9 protocols mpls interface lt-0/0/10.13 admin-group bronze
set logical-systems PE9 protocols mpls interface lt-0/0/10.15 admin-group gold
set logical-systems PE9 protocols mpls interface lt-0/0/10.15 admin-group silver
delete logical-systems PE9 protocols mpls interface lt-0/0/10.15 admin-group bronze
set logical-systems PE9 protocols mpls admin-groups gold 1
set logical-systems PE9 protocols mpls admin-groups silver 2
delete logical-systems PE9 protocols mpls admin-groups bronze 3



set logical-systems PE9 protocols mpls path SECONDARY


set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE7-Gold to 10.2.0.7
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE7-Gold primary path7 admin-group include-any gold



set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE7-Gold to 10.2.0.7
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE7-Gold secondary SECONDARY standby


set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE8-Gold to 10.2.0.8
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE8-Gold primary path7 admin-group include-any gold


set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE8-Gold to 10.2.0.8
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE8-Gold secondary SECONDARY standby

set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE10-Gold to 10.2.0.10
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE10-Gold primary path10 admin-group include-any gold


set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE10-Gold to 10.2.0.10
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE10-Gold secondary SECONDARY standby


set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE11-Gold to 10.2.0.11
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE11-Gold primary path11 admin-group include-any gold


set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE11-Gold to 10.2.0.11
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE11-Gold secondary SECONDARY standby


set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE12-Gold to 10.2.0.12
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE12-Gold primary path11 admin-group include-any gold

set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE12-Gold to 10.2.0.12
set logical-systems PE9 protocols mpls label-switched-path PE9-to-PE12-Gold secondary SECONDARY standby



set logical-systems PE9 protocols mpls path path7 10.2.0.7 loose
set logical-systems PE9 protocols mpls path path8 10.2.0.8 loose
set logical-systems PE9 protocols mpls path path3 10.2.0.9 loose
set logical-systems PE9 protocols mpls path path10 10.2.0.10 loose
set logical-systems PE9 protocols mpls path path11 10.2.0.11 loose
set logical-systems PE9 protocols mpls path path12 10.2.0.12 loose











************************************************************
	
						BGP CONFIG

************************************************************



PE7 and PE8 are route reflectors:


L3vpn allow 1 million routes command:

set logical-systems PE7 routing-options forwarding-table chained-composite-next-hop ingress l3vpn
set logical-systems PE8 routing-options forwarding-table chained-composite-next-hop ingress l3vpn
set logical-systems PE9 routing-options forwarding-table chained-composite-next-hop ingress l3vpn
set logical-systems PE10 routing-options forwarding-table chained-composite-next-hop ingress l3vpn
set logical-systems PE11 routing-options forwarding-table chained-composite-next-hop ingress l3vpn
set logical-systems PE12 routing-options forwarding-table chained-composite-next-hop ingress l3vpn


======
PE7 - RR
======

set logical-systems PE7 routing-options autonomous-system 65200
set logical-systems PE7 routing-options router-id 10.2.0.7


IBGP RR
set logical-systems PE7 protocols bgp group Core-RR-Client type internal
delete logical-systems PE7 protocols bgp group Core-RR-Client export aigp-originate
set logical-systems PE7 protocols bgp group Core-RR-Client export abr-next-hop-self
set logical-systems PE7 protocols bgp group Core-RR-Client cluster 10.2.0.7
set logical-systems PE7 protocols bgp group Core-RR-Client local-address 10.2.0.7
set logical-systems PE7 protocols bgp group Core-RR-Client family inet labeled-unicast resolve-vpn
set logical-systems PE7 protocols bgp group Core-RR-Client family inet labeled-unicast aigp
set logical-systems PE7 protocols bgp group Core-RR-Client family inet-vpn any
set logical-systems PE7 protocols bgp group Core-RR-Client local-as 65200
set logical-systems PE7 protocols bgp group Core-RR-Client neighbor 10.2.0.9 description "PE9"
set logical-systems PE7 protocols bgp group Core-RR-Client neighbor 10.2.0.10 description "PE10"
set logical-systems PE7 protocols bgp group Core-RR-Client neighbor 10.2.0.11 description "PE11"
set logical-systems PE7 protocols bgp group Core-RR-Client neighbor 10.2.0.12 description "PE12"


 set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA multihop ttl 255

 set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN multihop ttl 255


 set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA multihop ttl 255

 set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN multihop ttl 255



delete logical-systems PE7 protocols bgp group Core-RR-Peers

iBGP RR to RR peers group
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA type external
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA import apnic-import
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA export abr-export-label
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA local-address 10.2.0.7
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA family inet labeled-unicast resolve-vpn
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA family inet labeled-unicast aigp
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA family inet-vpn any
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA local-as 65200
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA peer-as 65100
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA neighbor 10.1.0.1 description "EMEA RR PE1"
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-EMEA neighbor 10.1.0.2 description "EMEA RR PE2"




set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN type external
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN import apnic-import
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN export abr-export-label
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN local-address 10.2.0.7
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN family inet labeled-unicast resolve-vpn
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN family inet labeled-unicast aigp
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN family inet-vpn any
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN local-as 65200
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN peer-as 65300
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN neighbor 10.3.0.13 description "ARIN RR PE13"
set logical-systems PE7 protocols bgp group Core-RR-Peers-to-ARIN neighbor 10.3.0.14 description "ARIN RR PE14"


set logical-systems PE7 protocols bgp group RR-Neighbor-Peer type internal
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer import rr-same-region-import
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer export abr-export-label
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer local-address 10.2.0.7
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer family inet labeled-unicast resolve-vpn
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer family inet labeled-unicast aigp
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer family inet-vpn any
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer local-as 65200
set logical-systems PE7 protocols bgp group RR-Neighbor-Peer neighbor 10.2.0.8 description "APNIC RR PE8"



set logical-systems PE7 policy-options policy-statement rr-same-region-import term EMEA-import from route-filter 10.1.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement rr-same-region-import term EMEA-import from community EMEA
set logical-systems PE7 policy-options policy-statement rr-same-region-import term EMEA-import then accept
set logical-systems PE7 policy-options policy-statement rr-same-region-import term APNIC-import from route-filter 10.2.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement rr-same-region-import term APNIC-import from community APNIC
set logical-systems PE7 policy-options policy-statement rr-same-region-import term APNIC-import then accept
set logical-systems PE7 policy-options policy-statement rr-same-region-import term ARIN-import from route-filter 10.3.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement rr-same-region-import term ARIN-import from community ARIN
set logical-systems PE7 policy-options policy-statement rr-same-region-import term ARIN-import then accept
set logical-systems PE7 policy-options policy-statement rr-same-region-import term community-all from community ALL
set logical-systems PE7 policy-options policy-statement rr-same-region-import term community-all then accept
set logical-systems PE7 policy-options policy-statement rr-same-region-import then reject





set logical-systems PE7 policy-options policy-statement apnic-import term EMEA-import from route-filter 10.1.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement apnic-import term EMEA-import from community EMEA
set logical-systems PE7 policy-options policy-statement apnic-import term EMEA-import then accept
set logical-systems PE7 policy-options policy-statement apnic-import term APNIC-import from route-filter 10.2.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement apnic-import term APNIC-import from community APNIC
set logical-systems PE7 policy-options policy-statement apnic-import term APNIC-import then reject
set logical-systems PE7 policy-options policy-statement apnic-import term ARIN-import from route-filter 10.3.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement apnic-import term ARIN-import from community ARIN
set logical-systems PE7 policy-options policy-statement apnic-import term ARIN-import then accept
set logical-systems PE7 policy-options policy-statement apnic-import term community-all from community ALL
set logical-systems PE7 policy-options policy-statement apnic-import term community-all then accept
set logical-systems PE7 policy-options policy-statement apnic-import then reject



This policy is done in the EMEA perspective if it was APNIC then the term EMEA-redist would be changed to APNIC-redist and route filter updated accordingly
set logical-systems PE7 policy-options policy-statement abr-export-label term aigp-originate from route-filter 10.2.0.7/32 exact
set logical-systems PE7 policy-options policy-statement abr-export-label term aigp-originate then aigp-originate 0
set logical-systems PE7 policy-options policy-statement abr-export-label term aigp-originate then community add APNIC
set logical-systems PE7 policy-options policy-statement abr-export-label term aigp-originate then accept
set logical-systems PE7 policy-options policy-statement abr-export-label term EMEA-redist from route-filter 10.1.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement abr-export-label term EMEA-redist then community set EMEA
set logical-systems PE7 policy-options policy-statement abr-export-label term EMEA-redist then accept
set logical-systems PE7 policy-options policy-statement abr-export-label term APNIC-redist from route-filter 10.2.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement abr-export-label term APNIC-redist then community set APNIC
set logical-systems PE7 policy-options policy-statement abr-export-label term APNIC-redist then accept
set logical-systems PE7 policy-options policy-statement abr-export-label term ARIN-redist from route-filter 10.3.0.0/16 orlonger
set logical-systems PE7 policy-options policy-statement abr-export-label term ARIN-redist then community set ARIN
set logical-systems PE7 policy-options policy-statement abr-export-label term ARIN-redist then accept
set logical-systems PE7 policy-options policy-statement abr-export-label term community-all from community ALL
set logical-systems PE7 policy-options policy-statement abr-export-label term community-all then accept
set logical-systems PE7 policy-options policy-statement abr-export-label then reject





set logical-systems PE7  policy-options policy-statement abr-next-hop-self term ARIN-redist from route-filter 10.3.0.0/16 orlonger
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term ARIN-redist then community set ARIN
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term ARIN-redist then next-hop self
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term ARIN-redist then accept
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term EMEA-redist from route-filter 10.1.0.0/16 orlonger
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term EMEA-redist then community set EMEA
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term EMEA-redist then next-hop self
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term EMEA-redist then accept
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term community-all from community ALL
set logical-systems PE7  policy-options policy-statement abr-next-hop-self term community-all then accept
set logical-systems PE7  policy-options policy-statement abr-next-hop-self then reject




set logical-systems PE7 policy-options community EMEA members target:13213:10
set logical-systems PE7 policy-options community APNIC members target:13213:11
set logical-systems PE7 policy-options community ARIN members target:13213:12
set logical-systems PE7 policy-options community ALL members target:13213:*





======
PE8 - RR
======

set logical-systems PE8 routing-options autonomous-system 65200
set logical-systems PE8 routing-options router-id 10.2.0.8

IBGP RR
set logical-systems PE8 protocols bgp group Core-RR-Client type internal
set logical-systems PE8 protocols bgp group Core-RR-Client export abr-next-hop-self
set logical-systems PE8 protocols bgp group Core-RR-Client cluster 10.2.0.8
set logical-systems PE8 protocols bgp group Core-RR-Client local-address 10.2.0.8
set logical-systems PE8 protocols bgp group Core-RR-Client family inet labeled-unicast resolve-vpn
set logical-systems PE8 protocols bgp group Core-RR-Client family inet labeled-unicast aigp
set logical-systems PE8 protocols bgp group Core-RR-Client family inet-vpn any
set logical-systems PE8 protocols bgp group Core-RR-Client local-as 65200
set logical-systems PE8 protocols bgp group Core-RR-Client neighbor 10.2.0.9 description "PE9"
set logical-systems PE8 protocols bgp group Core-RR-Client neighbor 10.2.0.10 description "PE10"
set logical-systems PE8 protocols bgp group Core-RR-Client neighbor 10.2.0.11 description "PE11"
set logical-systems PE8 protocols bgp group Core-RR-Client neighbor 10.2.0.12 description "PE12"




delete logical-systems PE8 protocols bgp group Core-RR-Peers

iBGP RR to RR peers group
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA type external
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA import apnic-import
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA export abr-export-label
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA local-address 10.2.0.8
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA family inet labeled-unicast resolve-vpn
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA family inet labeled-unicast aigp
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA family inet-vpn any
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA local-as 65200
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA peer-as 65100
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA neighbor 10.1.0.1 description "EMEA RR PE1"
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-EMEA neighbor 10.1.0.2 description "EMEA RR PE2"




set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN type external
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN import apnic-import
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN export abr-export-label
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN local-address 10.2.0.8
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN family inet labeled-unicast resolve-vpn
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN family inet labeled-unicast aigp
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN family inet-vpn any
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN local-as 65200
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN peer-as 65300
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN neighbor 10.3.0.13 description "ARIN RR PE13"
set logical-systems PE8 protocols bgp group Core-RR-Peers-to-ARIN neighbor 10.3.0.14 description "ARIN RR PE14"



set logical-systems PE8 protocols bgp group RR-Neighbor-Peer type internal
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer import rr-same-region-import
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer export abr-export-label
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer local-address 10.2.0.8
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer family inet labeled-unicast resolve-vpn
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer family inet labeled-unicast aigp
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer family inet-vpn any
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer local-as 65200
set logical-systems PE8 protocols bgp group RR-Neighbor-Peer neighbor 10.2.0.7 description "APNIC RR PE7"




set logical-systems PE8 policy-options policy-statement rr-same-region-import term EMEA-import from route-filter 10.1.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement rr-same-region-import term EMEA-import from community EMEA
set logical-systems PE8 policy-options policy-statement rr-same-region-import term EMEA-import then accept
set logical-systems PE8 policy-options policy-statement rr-same-region-import term APNIC-import from route-filter 10.2.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement rr-same-region-import term APNIC-import from community APNIC
set logical-systems PE8 policy-options policy-statement rr-same-region-import term APNIC-import then accept
set logical-systems PE8 policy-options policy-statement rr-same-region-import term ARIN-import from route-filter 10.3.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement rr-same-region-import term ARIN-import from community ARIN
set logical-systems PE8 policy-options policy-statement rr-same-region-import term ARIN-import then accept
set logical-systems PE8 policy-options policy-statement rr-same-region-import term community-all from community ALL
set logical-systems PE8 policy-options policy-statement rr-same-region-import term community-all then accept
set logical-systems PE8 policy-options policy-statement rr-same-region-import then reject



set logical-systems PE8 policy-options policy-statement apnic-import term EMEA-import from route-filter 10.1.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement apnic-import term EMEA-import from community EMEA
set logical-systems PE8 policy-options policy-statement apnic-import term EMEA-import then accept
set logical-systems PE8 policy-options policy-statement apnic-import term APNIC-import from route-filter 10.2.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement apnic-import term APNIC-import from community APNIC
set logical-systems PE8 policy-options policy-statement apnic-import term APNIC-import then reject
set logical-systems PE8 policy-options policy-statement apnic-import term ARIN-import from route-filter 10.3.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement apnic-import term ARIN-import from community ARIN
set logical-systems PE8 policy-options policy-statement apnic-import term ARIN-import then accept
set logical-systems PE8 policy-options policy-statement apnic-import term community-all from community ALL
set logical-systems PE8 policy-options policy-statement apnic-import term community-all then accept
set logical-systems PE8 policy-options policy-statement apnic-import then reject



set logical-systems PE8 policy-options policy-statement abr-export-label term aigp-originate from route-filter 10.2.0.8/32 exact
set logical-systems PE8 policy-options policy-statement abr-export-label term aigp-originate then aigp-originate 0
set logical-systems PE8 policy-options policy-statement abr-export-label term aigp-originate then community add APNIC
set logical-systems PE8 policy-options policy-statement abr-export-label term aigp-originate then accept
set logical-systems PE8 policy-options policy-statement abr-export-label term EMEA-redist from route-filter 10.1.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement abr-export-label term EMEA-redist then community set EMEA
set logical-systems PE8 policy-options policy-statement abr-export-label term EMEA-redist then accept
set logical-systems PE8 policy-options policy-statement abr-export-label term APNIC-redist from route-filter 10.2.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement abr-export-label term APNIC-redist then community set APNIC
set logical-systems PE8 policy-options policy-statement abr-export-label term APNIC-redist then accept
set logical-systems PE8 policy-options policy-statement abr-export-label term ARIN-redist from route-filter 10.3.0.0/16 orlonger
set logical-systems PE8 policy-options policy-statement abr-export-label term ARIN-redist then community set ARIN
set logical-systems PE8 policy-options policy-statement abr-export-label term ARIN-redist then accept
set logical-systems PE8 policy-options policy-statement abr-export-label term community-all from community ALL
set logical-systems PE8 policy-options policy-statement abr-export-label term community-all then accept
set logical-systems PE8 policy-options policy-statement abr-export-label then reject





set logical-systems PE8  policy-options policy-statement abr-next-hop-self term ARIN-redist from route-filter 10.3.0.0/16 orlonger
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term ARIN-redist then community set ARIN
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term ARIN-redist then next-hop self
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term ARIN-redist then accept
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term EMEA-redist from route-filter 10.1.0.0/16 orlonger
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term EMEA-redist then community set EMEA
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term EMEA-redist then next-hop self
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term EMEA-redist then accept
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term community-all from community ALL
set logical-systems PE8  policy-options policy-statement abr-next-hop-self term community-all then accept
set logical-systems PE8  policy-options policy-statement abr-next-hop-self then reject



set logical-systems PE8 policy-options community EMEA members target:13213:10
set logical-systems PE8 policy-options community APNIC members target:13213:11
set logical-systems PE8 policy-options community ARIN members target:13213:12
set logical-systems PE8 policy-options community ALL members target:13213:*


=====
PE9
=====

set logical-systems PE9 routing-options autonomous-system 65200
set logical-systems PE9 routing-options router-id 10.2.0.9

RR Client Config
set logical-systems PE9 protocols bgp group Core-RR type internal
set logical-systems PE9 protocols bgp group Core-RR export aigp-originate
delete logical-systems PE9 protocols bgp group Core-RR export abr-export-label
set logical-systems PE9 protocols bgp group Core-RR local-address 10.2.0.9
set logical-systems PE9 protocols bgp group Core-RR family inet labeled-unicast resolve-vpn
set logical-systems PE9 protocols bgp group Core-RR family inet labeled-unicast aigp
set logical-systems PE9 protocols bgp group Core-RR family inet-vpn any
set logical-systems PE9 protocols bgp group Core-RR local-as 65200
set logical-systems PE9 protocols bgp group Core-RR neighbor 10.2.0.7 description "RR PE7"
set logical-systems PE9 protocols bgp group Core-RR neighbor 10.2.0.8 description "RR PE8"




ABR Specific
delete logical-systems PE9 protocols bgp group Core-ABR
#set logical-systems PE9 protocols bgp group Core-ABR type internal
#set logical-systems PE9 protocols bgp group Core-ABR import apnic-import
#set logical-systems PE9 protocols bgp group Core-ABR export abr-export-label
#set logical-systems PE9 protocols bgp group Core-ABR family inet labeled-unicast resolve-vpn
#set logical-systems PE9 protocols bgp group Core-ABR family inet labeled-unicast aigp
#set logical-systems PE9 protocols bgp group Core-ABR family inet-vpn any
#set logical-systems PE9 protocols bgp group Core-ABR local-as 65200
#delete logical-systems PE9 protocols bgp group Core-ABR local-address 10.2.0.10
#delete logical-systems PE9 protocols bgp group Core-ABR local-address 10.2.0.9
#set logical-systems PE9 protocols bgp group Core-ABR neighbor 10.1.0.4 description "RR PE4"
#delete logical-systems PE9 protocols bgp group Core-ABR local-address 10.100.1.1
#delete logical-systems PE9 protocols bgp group Core-ABR neighbor 10.100.1.0 description "RR PE4"


delete logical-systems PE9 policy-options policy-statement aigp-originate 
set logical-systems PE9 policy-options policy-statement aigp-originate term aigp-originate from route-filter 10.2.0.9/32 exact
set logical-systems PE9 policy-options policy-statement aigp-originate term aigp-originate then aigp-originate 0
set logical-systems PE9 policy-options policy-statement aigp-originate term aigp-originate then community add APNIC
set logical-systems PE9 policy-options policy-statement aigp-originate term aigp-originate then accept
#set logical-systems PE9 policy-options policy-statement aigp-originate term reject-local-area-routes from route-filter 10.2.0.0/16 orlonger
#set logical-systems PE9 policy-options policy-statement aigp-originate term reject-local-area-routes then reject
set logical-systems PE9 policy-options policy-statement aigp-originate term accept-all then reject
set logical-systems PE9 policy-options policy-statement aigp-originate then reject


delete logical-systems PE9 policy-options policy-statement apnic-import
#set logical-systems PE9 policy-options policy-statement apnic-import term EMEA-import from route-filter 10.1.0.0/16 orlonger
#set logical-systems PE9 policy-options policy-statement apnic-import term EMEA-import from community EMEA
#set logical-systems PE9 policy-options policy-statement apnic-import term EMEA-import then accept
#set logical-systems PE9 policy-options policy-statement apnic-import term APNIC-import from route-filter 10.2.0.0/16 orlonger
#set logical-systems PE9 policy-options policy-statement apnic-import term APNIC-import from community APNIC
#set logical-systems PE9 policy-options policy-statement apnic-import term APNIC-import then reject
#set logical-systems PE9 policy-options policy-statement apnic-import term ARIN-import from route-filter 10.3.0.0/16 orlonger
#set logical-systems PE9 policy-options policy-statement apnic-import term ARIN-import from community ARIN
#set logical-systems PE9 policy-options policy-statement apnic-import term ARIN-import then accept
#set logical-systems PE9 policy-options policy-statement apnic-import term community-all from community ALL
#set logical-systems PE9 policy-options policy-statement apnic-import term community-all then accept
#set logical-systems PE9 policy-options policy-statement apnic-import then reject



delete logical-systems PE9 policy-options policy-statement abr-export-label
#set logical-systems PE9 policy-options policy-statement abr-export-label term aigp-originate from route-filter 10.2.0.9/32 exact
#set logical-systems PE9 policy-options policy-statement abr-export-label term aigp-originate then aigp-originate 0
#set logical-systems PE9 policy-options policy-statement abr-export-label term aigp-originate then community add APNIC
#set logical-systems PE9 policy-options policy-statement abr-export-label term aigp-originate then accept
#set logical-systems PE9 policy-options policy-statement abr-export-label term EMEA-redist from route-filter 10.1.0.0/16 orlonger
#set logical-systems PE9 policy-options policy-statement abr-export-label term EMEA-redist then community set EMEA
#set logical-systems PE9 policy-options policy-statement abr-export-label term EMEA-redist then accept
#set logical-systems PE9 policy-options policy-statement abr-export-label term APNIC-redist from route-filter 10.2.0.0/16 orlonger
#set logical-systems PE9 policy-options policy-statement abr-export-label term APNIC-redist then community set APNIC
#set logical-systems PE9 policy-options policy-statement abr-export-label term APNIC-redist then accept
#set logical-systems PE9 policy-options policy-statement abr-export-label term ARIN-redist from route-filter 10.3.0.0/16 orlonger
#set logical-systems PE9 policy-options policy-statement abr-export-label term ARIN-redist then community set ARIN
#set logical-systems PE9 policy-options policy-statement abr-export-label term ARIN-redist then accept
#set logical-systems PE9 policy-options policy-statement abr-export-label term community-all from community ALL
#set logical-systems PE9 policy-options policy-statement abr-export-label term community-all then accept
#set logical-systems PE9 policy-options policy-statement abr-export-label then reject




delete logical-systems PE9  policy-options policy-statement abr-next-hop-self 




set logical-systems PE9 policy-options community EMEA members target:13213:10
set logical-systems PE9 policy-options community APNIC members target:13213:11
set logical-systems PE9 policy-options community ARIN members target:13213:12
set logical-systems PE9 policy-options community ALL members target:13213:*



=====
PE10
=====

set logical-systems PE10 routing-options autonomous-system 65200
set logical-systems PE10 routing-options router-id 10.2.0.10

RR Client Config
set logical-systems PE10 protocols bgp group Core-RR type internal
set logical-systems PE10 protocols bgp group Core-RR export aigp-originate
set logical-systems PE10 protocols bgp group Core-RR local-address 10.2.0.10
set logical-systems PE10 protocols bgp group Core-RR family inet labeled-unicast resolve-vpn
set logical-systems PE10 protocols bgp group Core-RR family inet labeled-unicast aigp
set logical-systems PE10 protocols bgp group Core-RR family inet-vpn any
set logical-systems PE10 protocols bgp group Core-RR local-as 65200
set logical-systems PE10 protocols bgp group Core-RR neighbor 10.2.0.7 description "RR PE7"
set logical-systems PE10 protocols bgp group Core-RR neighbor 10.2.0.8 description "RR PE8"



set logical-systems PE10 policy-options policy-statement aigp-originate term aigp-originate from route-filter 10.2.0.10/32 exact
set logical-systems PE10 policy-options policy-statement aigp-originate term aigp-originate then aigp-originate 0
set logical-systems PE10 policy-options policy-statement aigp-originate term aigp-originate then community add APNIC
set logical-systems PE10 policy-options policy-statement aigp-originate term aigp-originate then accept
set logical-systems PE10 policy-options policy-statement aigp-originate term accept-all then reject
set logical-systems PE10 policy-options policy-statement aigp-originate then reject



set logical-systems PE10 policy-options community EMEA members target:13213:10
set logical-systems PE10 policy-options community APNIC members target:13213:11
set logical-systems PE10 policy-options community ARIN members target:13213:12
set logical-systems PE10 policy-options community ALL members target:13213:*


=====
PE11
=====


set logical-systems PE11 routing-options autonomous-system 65200
set logical-systems PE11 routing-options router-id 10.2.0.11

RR Client Config
set logical-systems PE11 protocols bgp group Core-RR type internal
set logical-systems PE11 protocols bgp group Core-RR export aigp-originate
set logical-systems PE11 protocols bgp group Core-RR local-address 10.2.0.11
set logical-systems PE11 protocols bgp group Core-RR family inet labeled-unicast resolve-vpn
set logical-systems PE11 protocols bgp group Core-RR family inet labeled-unicast aigp
set logical-systems PE11 protocols bgp group Core-RR family inet-vpn any
set logical-systems PE11 protocols bgp group Core-RR local-as 65200
set logical-systems PE11 protocols bgp group Core-RR neighbor 10.2.0.7 description "RR PE7"
set logical-systems PE11 protocols bgp group Core-RR neighbor 10.2.0.8 description "RR PE8"



set logical-systems PE11 policy-options policy-statement aigp-originate term aigp-originate from route-filter 10.2.0.11/32 exact
set logical-systems PE11 policy-options policy-statement aigp-originate term aigp-originate then aigp-originate 0
set logical-systems PE11 policy-options policy-statement aigp-originate term aigp-originate then community add APNIC
set logical-systems PE11 policy-options policy-statement aigp-originate term aigp-originate then accept
set logical-systems PE11 policy-options policy-statement aigp-originate term accept-all then reject
set logical-systems PE11 policy-options policy-statement aigp-originate then reject



set logical-systems PE11 policy-options community EMEA members target:13213:10
set logical-systems PE11 policy-options community APNIC members target:13213:11
set logical-systems PE11 policy-options community ARIN members target:13213:12
set logical-systems PE11 policy-options community ALL members target:13213:*



=====
PE12
=====

set logical-systems PE12 routing-options autonomous-system 65200
set logical-systems PE12 routing-options router-id 10.2.0.12

RR Client Config
set logical-systems PE12 protocols bgp group Core-RR type internal
set logical-systems PE12 protocols bgp group Core-RR export aigp-originate
set logical-systems PE12 protocols bgp group Core-RR local-address 10.2.0.12
set logical-systems PE12 protocols bgp group Core-RR family inet labeled-unicast resolve-vpn
set logical-systems PE12 protocols bgp group Core-RR family inet labeled-unicast aigp
set logical-systems PE12 protocols bgp group Core-RR family inet-vpn any
set logical-systems PE12 protocols bgp group Core-RR local-as 65200
set logical-systems PE12 protocols bgp group Core-RR neighbor 10.2.0.7 description "RR PE7"
set logical-systems PE12 protocols bgp group Core-RR neighbor 10.2.0.8 description "RR PE8"



set logical-systems PE12 policy-options policy-statement aigp-originate term aigp-originate from route-filter 10.2.0.12/32 exact
set logical-systems PE12 policy-options policy-statement aigp-originate term aigp-originate then aigp-originate 0
set logical-systems PE12 policy-options policy-statement aigp-originate term aigp-originate then community add APNIC
set logical-systems PE12 policy-options policy-statement aigp-originate term aigp-originate then accept
set logical-systems PE12 policy-options policy-statement aigp-originate term accept-all then reject
set logical-systems PE12 policy-options policy-statement aigp-originate then reject





set logical-systems PE12 policy-options community EMEA members target:13213:10
set logical-systems PE12 policy-options community APNIC members target:13213:11
set logical-systems PE12 policy-options community ARIN members target:13213:12
set logical-systems PE12 policy-options community ALL members target:13213:*











--------------------------------------------------


*******************L3VPN*********************

PE12:

set logical-systems PE12 policy-options community thg members target:13213:5387

set logical-systems PE12 policy-options policy-statement thg-export term thg then community set thg
set logical-systems PE12 policy-options policy-statement thg-export term thg then accept
set logical-systems PE12 policy-options policy-statement thg-export then reject

set logical-systems PE12 policy-options policy-statement thg-import term thg from community thg
set logical-systems PE12 policy-options policy-statement thg-import term thg then accept
set logical-systems PE12 policy-options policy-statement thg-import then reject

set logical-systems PE12 routing-instances thg instance-type vrf
set logical-systems PE12 routing-instances thg interface lo0.5387
set logical-systems PE12 routing-instances thg route-distinguisher 13213:5387
set logical-systems PE12 routing-instances thg vrf-import thg-import
set logical-systems PE12 routing-instances thg vrf-export thg-export
set logical-systems PE12 routing-instances thg vrf-table-label
set logical-systems PE12 routing-instances thg routing-options auto-export

set logical-systems PE12 interfaces lo0 unit 5399 family inet address 172.1.1.12/32

delete logical-systems PE12 interfaces lo0.5399



*******************L3VPN*********************

PE10:

set logical-systems PE10 policy-options community thg members target:13213:5387

set logical-systems PE10 policy-options policy-statement thg-export term thg then community set thg
set logical-systems PE10 policy-options policy-statement thg-export term thg then accept
set logical-systems PE10 policy-options policy-statement thg-export then reject

set logical-systems PE10 policy-options policy-statement thg-import term thg from community thg
set logical-systems PE10 policy-options policy-statement thg-import term thg then accept
set logical-systems PE10 policy-options policy-statement thg-import then reject

set logical-systems PE10 routing-instances thg instance-type vrf
set logical-systems PE10 routing-instances thg interface lo0.5390
set logical-systems PE10 routing-instances thg route-distinguisher 13213:5387
set logical-systems PE10 routing-instances thg vrf-import thg-import
set logical-systems PE10 routing-instances thg vrf-export thg-export
set logical-systems PE10 routing-instances thg vrf-table-label
set logical-systems PE10 routing-instances thg routing-options auto-export

set logical-systems PE10 interfaces lo0 unit 5390 family inet address 172.1.1.10/32







	PE11:

	set logical-systems PE11 policy-options community thg members target:13213:5387

	set logical-systems PE11 policy-options policy-statement thg-export term thg then community set thg
	set logical-systems PE11 policy-options policy-statement thg-export term thg then accept
	set logical-systems PE11 policy-options policy-statement thg-export then reject

	set logical-systems PE11 policy-options policy-statement thg-import term thg from community thg
	set logical-systems PE11 policy-options policy-statement thg-import term thg then accept
	set logical-systems PE11 policy-options policy-statement thg-import then reject

	set logical-systems PE11 routing-instances thg instance-type vrf
	set logical-systems PE11 routing-instances thg interface lo0.5387
	set logical-systems PE11 routing-instances thg route-distinguisher 13213:5387
	set logical-systems PE11 routing-instances thg vrf-import thg-import
	set logical-systems PE11 routing-instances thg vrf-export thg-export
	set logical-systems PE11 routing-instances thg vrf-table-label
	set logical-systems PE11 routing-instances thg routing-options auto-export

	set logical-systems PE11 interfaces lo0 unit 5387 family inet address 172.1.1.11/32








-------
set logical-systems PE11 routing-instances thg protocols bgp group Core-RR type external
set logical-systems PE11 routing-instances thg protocols bgp group Core-RR local-address 10.20.9.0
set logical-systems PE11 routing-instances thg protocols bgp group Core-RR local-as 65200
set logical-systems PE11 routing-instances thg protocols bgp group Core-RR peer-as 10011
set logical-systems PE11 routing-instances thg protocols bgp group Core-RR neighbor 10.20.9.1 description "CE11 - PE11"






set logical-systems PE11 interfaces lt-0/0/10 unit 19 encapsulation vlan
set logical-systems PE11 interfaces lt-0/0/10 unit 19 vlan-id 2
set logical-systems PE11 interfaces lt-0/0/10 unit 19 description "Link to CE11"
set logical-systems PE11 interfaces lt-0/0/10 unit 19 peer-unit 20
set logical-systems PE11 interfaces lt-0/0/10 unit 19 family inet address 10.20.9.0/31

set logical-systems PE11 routing-instances thg interface lt-0/0/10.19


-------------------------

===
CE11
===
CE Router peering with CE11:



set logical-systems CE11 routing-options autonomous-system 10011
set logical-systems CE11 routing-options router-id 10.20.9.1

set logical-systems CE11 interfaces lt-0/0/10 unit 20 encapsulation vlan
set logical-systems CE11 interfaces lt-0/0/10 unit 20 vlan-id 2
set logical-systems CE11 interfaces lt-0/0/10 unit 20 description "Link to PE6"
set logical-systems CE11 interfaces lt-0/0/10 unit 20 peer-unit 19
set logical-systems CE11 interfaces lt-0/0/10 unit 20 family inet address 10.20.9.1/31




set logical-systems CE11 protocols bgp group Core-RR type external
set logical-systems CE11 protocols bgp group Core-RR local-address 10.20.9.1
set logical-systems CE11 protocols bgp group Core-RR local-as 10011
set logical-systems CE11 protocols bgp group Core-RR peer-as 65200
set logical-systems CE11 protocols bgp group Core-RR neighbor 10.20.9.0 description "CE11 - PE6"




set logical-systems CE11 interface lo0 unit 8000 family inet address 50.50.50.50/32





set logical-systems CE11  policy-options policy-statement allow-all from protocol direct

set logical-systems CE11  policy-options policy-statement allow-all then accept


set logical-systems CE11  protocols bgp group Core-RR export allow-all
